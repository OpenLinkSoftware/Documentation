<?xml version="1.0" encoding="UTF-8"?>
<section xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://docbook.org/ns/docbook" xml:id="vdbenginepr">
      <info>
        <title>Using Microsoft Entity Frameworks to Access Progress Schema Objects with Virtuoso</title>
        <abstract>
          <para>This section details the steps required to provide Microsoft Entity Framework access to
Progress Schema Objects using the OpenLink Virtuoso Universal Server. This is achieved by Linking the
required Progress Schema objects into Virtuoso using its built in Virtual Database engine, and then using
the Virtuoso ADO.Net Entity Framework provider to query the remote Progress Schema objects linked into
the Virtuoso Server.
      </para>
        </abstract>
      </info>
      <bridgehead>Prerequisites</bridgehead>
      <formalpara>
        <title>Progress OpenEdge 10</title>
        <para>A Progress DBMS hosting the required Schema Objects needs to be available. In this section,
the <emphasis>isports</emphasis>

   sample database will be used to demonstrate the process.
    </para>
      </formalpara>
      <para>A Progress DBMS hosting the required Schema Objects needs to be available. In this section,
the <emphasis>isports</emphasis>

   sample database will be used to demonstrate the process.
    </para>
      <formalpara>
        <title>OpenLink ODBC Driver for Progress (SQL-92)</title>
        <para>A Progress ODBC Driver is required to link the Progress Schema Objects into the Virtuoso Server.
The OpenLink <emphasis>ODBC Driver for Progress (SQL-92)</emphasis>

   will be used in this section, for
which a functional ODBC Data source name of "<emphasis>prs101c</emphasis>

  " will be assumed to exist on the
machine hosting the Virtuoso Server.
    </para>
      </formalpara>
      <para>A Progress ODBC Driver is required to link the Progress Schema Objects into the Virtuoso Server.
The OpenLink <emphasis>ODBC Driver for Progress (SQL-92)</emphasis>

   will be used in this section, for
which a functional ODBC Data source name of "<emphasis>prs101c</emphasis>

  " will be assumed to exist on the
machine hosting the Virtuoso Server.
    </para>
      <formalpara>
        <title>OpenLink Virtuoso 5.10.x</title>
        <para>An OpenLink Virtuoso Universal Server installation including the Virtuoso Universal Server and
ADO.NET Entity Framework Provider is required. The Virtuoso components must be Release 5.10.x or above,
this being the minimum version containing support for Microsoft Entity Frameworks.</para>
      </formalpara>
      <para>An OpenLink Virtuoso Universal Server installation including the Virtuoso Universal Server and
ADO.NET Entity Framework Provider is required. The Virtuoso components must be Release 5.10.x or above,
this being the minimum version containing support for Microsoft Entity Frameworks.</para>
      <formalpara>
        <title>Microsoft Visual Studio 2008 + SP1</title>
        <para>Microsoft Visual Studio 2008 with Service Pack 1 is required, this being the only version
containing the necessary Entity Framework support available at the time of writing.</para>
      </formalpara>
      <para>Microsoft Visual Studio 2008 with Service Pack 1 is required, this being the only version
containing the necessary Entity Framework support available at the time of writing.</para>
      <bridgehead>Tasks</bridgehead>
      <formalpara>
        <title>Ensure Progress Primary Keys (PKs) are not nullable</title>
        <para>The Visual Studio 2008 Entity Data Model (EDM) requires that all primary keys are NOT Nullable,
and will fail to generate an EDM if any are nullable. Thus ensure any tables to be used are defined as not
nullable in the Progress database schema before attempting to generate an EDM.
    </para>
      </formalpara>
      <para>The Visual Studio 2008 Entity Data Model (EDM) requires that all primary keys are NOT Nullable,
and will fail to generate an EDM if any are nullable. Thus ensure any tables to be used are defined as not
nullable in the Progress database schema before attempting to generate an EDM.
    </para>
      <para>It seems that, by default, several Primary Keys (PKs) in the isports database allows &lt;NULL&gt;
values. It seems somewhat nonsensical - that a unique key used, specifically, to identify a row in a table
can be allowed to be &lt;NULL&gt;.
    </para>
      <para>This issue is best addressed directly in the database schema, by redefining those PKs that allow
&lt;NULL&gt; so as not to allow &lt;NULL&gt;. Progress does not seem to talk in terms of &lt;NULL&gt;, instead
using the term "Mandatory"
    </para>
      <para>The following section will provide more specific details about how to ensure Progress PKs
are not nullable:
    </para>
      <itemizedlist mark="bullet">
        <listitem>
          <para>Ensuring Progress PKs are not nullable</para>
        </listitem>
      </itemizedlist>
      <section xml:id="vdbengineprinst">
        <title>Install and configure OpenLink ODBC Driver for Progress (SQL-92)</title>
        <para>The Virtuoso Virtual Database engine uses ODBC as the connectivity mechanism for linking
remote database objects into its local schema. Thus a Progress ODBC Driver must be available with a
suitably configured DSN for connecting to the target database. The OpenLink ODBC Drivers for Progress
have been used in this section, although in theory any Progress ODBC Driver can be used.</para>
        <para>Installation instructions for the OpenLink ODBC Driver for Oracle are available from:</para>
        <itemizedlist mark="bullet">
          <listitem>
            <para>
              <link xlink:href="http://wikis.openlinksw.com/dataspace/owiki/wiki/UdaWikiWeb/InstallConfigODBC">Product
Installation &amp; Basic Configuration (ODBC)</link>
            </para>
          </listitem>
        </itemizedlist>
      </section>
      <section xml:id="vdbengineprconfvsr">
        <title>Install and configure OpenLink Virtuoso Universal Server</title>
        <itemizedlist mark="bullet">
          <listitem>
            <para>
              <link linkend="virtclientrefinstallandconfigvirt">Install and configure OpenLink Virtuoso Universal Server</link>
            </para>
          </listitem>
        </itemizedlist>
      </section>
      <section xml:id="vdbengineprlnk">
        <title>Linking Progress tables into Virtuoso</title>
        <orderedlist>
          <listitem>
            <para>Start the Virtuoso Web User Interface
    </para>
            <figure xml:id="lpro1" floatstyle="1">
              <title>Start</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lora1.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select the "Conductor" link in the Left Frame and Login as the "dba" user.
    </para>
            <figure xml:id="lpro2" floatstyle="1">
              <title>Conductor</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lora2.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select the "Databases" -&gt; "External Data Source" -&gt; "Data Sources" tab menu items
    </para>
            <figure xml:id="lpro3" floatstyle="1">
              <title>Databases</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro3.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select the "Connect" button for the "prs10ma" Oracle DSN.
    </para>
            <figure xml:id="lpro4" floatstyle="1">
              <title>Connect</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro4.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>On successful connection Select the "Link Objects" button to obtain a list of available tables
    </para>
            <figure xml:id="lpro5" floatstyle="1">
              <title>Link Objects</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro5.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select all the tables that are part of the "isports" catalog.
    </para>
            <figure xml:id="lpro6" floatstyle="1">
              <title>Select all tables</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro6.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Change the Catalog for each table to be "isports" using the "Set All" button.
    </para>
            <figure xml:id="lpro7" floatstyle="1">
              <title>Catalog</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro7.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>All the catalog names are changed to be "isports".
    </para>
            <figure xml:id="lpro8" floatstyle="1">
              <title>Catalog names</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro8.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select the "Link" button to link the selected tables into Virtuoso
    </para>
            <figure xml:id="lpro9" floatstyle="1">
              <title>"Link" button</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro9.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>On completion of the Link process the tables will be displayed in the "External Linked Objects" tab.
    </para>
            <figure xml:id="lpro10" floatstyle="1">
              <title>Completion</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro10.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>At this point you can test the remotely linked tables by clicking on the link that accompanies
each table. e.g. isports.prs101c.Customer.</para>
            <para>This will display the Interactive ISQL interface which will have been already populated with a
suitable SQL statement.
    </para>
            <figure xml:id="lpro11" floatstyle="1">
              <title>Querying</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro11.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select Execute to see data from the remotely linked table.
    </para>
            <figure xml:id="lpro12" floatstyle="1">
              <title>Execute</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro12.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>The tables can also be viewed as part of the Virtuoso "SQL Schema Objects" under the "isports" catalog name.
    </para>
            <figure xml:id="lpro13" floatstyle="1">
              <title>SQL Schema Objects</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/lpro13.png"/>
                </imageobject>
              </mediaobject>
            </figure>
            <para>The Link process is now complete enabling the tables to be queried as if part of the Virtuoso Schema.</para>
          </listitem>
        </orderedlist>
      </section>
      <section xml:id="vdbengineprcrem">
        <title>Creating EDM in Visual Studio 2008</title>
        <para>The following steps can be used to create an Entity Data Model (EDM) for the Progress isports database:</para>
        <orderedlist>
          <listitem>
            <para>Launch the Visual Studio 2008 SP1 IDE.
    </para>
            <figure xml:id="epro1" floatstyle="1">
              <title>Visual Studio 2008 SP1 IDE</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/dora1.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Create a </para>
            <para>
              <emphasis>Web Application</emphasis>
            </para>
            <para> project by going to the </para>
            <para>
              <emphasis>File</emphasis>
            </para>
            <para>
menu in Visual Studio and choosing </para>
            <para>
              <emphasis>New Project</emphasis>
            </para>
            <para>.
    </para>
            <figure xml:id="epro2_02" floatstyle="1">
              <title>Web Application</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro2.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>When the New Project window appears, choose either </para>
            <para>
              <emphasis>Visual Basic</emphasis>
            </para>
            <para> or
</para>
            <para>
              <emphasis>Visual C#</emphasis>
            </para>
            <para> as your programming language.</para>
          </listitem>
          <listitem>
            <para>Within the language category, click on </para>
            <para>
              <emphasis>Web</emphasis>
            </para>
            <para> and select
</para>
            <para>
              <emphasis>ASP.NET Web Application</emphasis>
            </para>
            <para> from the right-hand panel. </para>
          </listitem>
          <listitem>
            <para>Choose a name for the project, for example </para>
            <para>
              <emphasis>isports</emphasis>
            </para>
            <para>, and
click </para>
            <para>
              <emphasis>OK</emphasis>
            </para>
            <para>.
    </para>
            <figure xml:id="epro3" floatstyle="1">
              <title>Name for the project</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro3.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>This will create a new project called </para>
            <para>
              <emphasis>isports</emphasis>
            </para>
            <para>.
    </para>
            <figure xml:id="epro4" floatstyle="1">
              <title>create a new project</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro4.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select the Project -&gt; Add New Item menu option.
    </para>
            <figure xml:id="epro5" floatstyle="1">
              <title>New Item</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/einf4.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>The </para>
            <para>
              <emphasis>Add New Item</emphasis>
            </para>
            <para> dialog will appear. Choose the
</para>
            <para>
              <emphasis>ADO.NET Entity Data Model</emphasis>
            </para>
            <para> template. Give it the name </para>
            <para>
              <emphasis>Model1.edmx</emphasis>
            </para>
            <para>
and click </para>
            <para>
              <emphasis>Add</emphasis>
            </para>
            <para> to start the creation of the ADO.Net Entity Data Model.
    </para>
            <figure xml:id="epro6" floatstyle="1">
              <title>Add New Item</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro6.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>In the </para>
            <para>
              <emphasis>Entity Data Model Wizard</emphasis>
            </para>
            <para> dialog
</para>
            <para>
              <emphasis>Choose Model Contents</emphasis>
            </para>
            <para> page select the </para>
            <para>
              <emphasis>Generate from Database</emphasis>
            </para>
            <para>
model type and click </para>
            <para>
              <emphasis>Next</emphasis>
            </para>
            <para>.
    </para>
            <figure xml:id="eora6_01" floatstyle="1">
              <title>Choose Model Contents</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/eora6.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>In the </para>
            <para>
              <emphasis>Entity Data Model Wizard</emphasis>
            </para>
            <para> dialog
</para>
            <para>
              <emphasis>Choose your Data Connection</emphasis>
            </para>
            <para> page, select the </para>
            <para>
              <emphasis>New Connection button</emphasis>
            </para>
            <figure xml:id="epro8" floatstyle="1">
              <title>Entity Data Model Wizard</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/dora8.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>In the </para>
            <para>
              <emphasis>Choose Data Source</emphasis>
            </para>
            <para> dialog, select the OpenLink
</para>
            <para>
              <emphasis>Virtuoso Data Source</emphasis>
            </para>
            <para> from the list and click </para>
            <para>
              <emphasis>Continue</emphasis>
            </para>
            <para>.
    </para>
            <figure xml:id="epro9" floatstyle="1">
              <title>Choose Data Source</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/dora9.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>In the </para>
            <para>
              <emphasis>Add Connection</emphasis>
            </para>
            <para> dialog, specify the
</para>
            <para>
              <emphasis>hostname, portno, username and password</emphasis>
            </para>
            <para> for the target Virtuoso Server and check the Save Password check box.
    </para>
            <figure xml:id="dora10_02" floatstyle="1">
              <title>Connection Properties</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/dora10.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Select the </para>
            <para>
              <emphasis>Select Database From List</emphasis>
            </para>
            <para> radio button and choose the
</para>
            <para>
              <emphasis>isports</emphasis>
            </para>
            <para> database from the drop down list.
    </para>
            <figure xml:id="epro11" floatstyle="1">
              <title>Add connection</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro11.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Press the </para>
            <para>
              <emphasis>Test Connection</emphasis>
            </para>
            <para> dialog to verify that the database is accessible.
    </para>
            <figure xml:id="epro12" floatstyle="1">
              <title>Test Connection</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/dora12.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Set the </para>
            <para>
              <emphasis>entity connect string</emphasis>
            </para>
            <para> name to
</para>
            <para>
              <emphasis>isportsEntities</emphasis>
            </para>
            <para> (note this name as it is required in the section on creating and
ADO.Net Data Service) and click </para>
            <para>
              <emphasis>Next</emphasis>
            </para>
            <para>.
    </para>
            <figure xml:id="epro13" floatstyle="1">
              <title>entity connect string</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro13.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>In the </para>
            <para>
              <emphasis>Choose your Database Objects</emphasis>
            </para>
            <para> page select the
</para>
            <para>
              <emphasis>Tables</emphasis>
            </para>
            <para> check box to select all tables in the isports catalog for addition to the
Entity Data Model. Set the </para>
            <para>
              <emphasis>Model Namespace</emphasis>
            </para>
            <para> to </para>
            <para>
              <emphasis>isportsModel</emphasis>
            </para>
            <para> and
click </para>
            <para>
              <emphasis>Finish</emphasis>
            </para>
            <para>.
    </para>
            <figure xml:id="epro14" floatstyle="1">
              <title>Database Objects</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro14.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>The </para>
            <para>
              <emphasis>Model1.edmx</emphasis>
            </para>
            <para> EDM will be created with the tables and relationships
displayed in the Visual Studio IDE.
    </para>
            <figure xml:id="epro15" floatstyle="1">
              <title>Virtuoso.edmx</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/epro15.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
        </orderedlist>
        <para>Creation for the Entity Data Model for the Progress isports database is now complete.</para>
      </section>
      <section xml:id="vdbengineprmedm">
        <title>Manually creating EDM Associations (FKs) for the Progress isports database</title>
        <para>The following steps will detail what is required to manually create "Associations" in your Entity Data Model.</para>
        <para>You will need to determine where these associations exist and their multiplicity (one-to-one,
one-to-many, etc.) before commencing with the following steps.</para>
        <para><emphasis>Note:</emphasis>

  These steps will need to be repeated for each association.</para>
        <orderedlist>
          <listitem>
            <para>The first Association will deal with is the relationship between Customer and Invoice,
identified by the presence of the scalar property Cust_Num in both entities. This is a one-to-many
relationship, as a Customer may have any number of Invoices.
    </para>
            <figure xml:id="mpro1" floatstyle="1">
              <title>Association</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro1.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>To add the Association, right click on the Customer entity then Add -&gt; Association.
    </para>
            <figure xml:id="mpro2" floatstyle="1">
              <title>add the Association</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro2.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>You will now see the Add Association dialog.
    </para>
            <figure xml:id="mpro3" floatstyle="1">
              <title>Add Association dialog</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro3.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>For this association the only thing that needs changing from the default, is the name of the Navigation Property from
Invoice to invoices on the Customer end of the association.
    </para>
            <para>This better reflects the multiplicity of the association such that a Customer is associated with zero or
many Invoices (plural).</para>
            <figure xml:id="mpro4" floatstyle="1">
              <title>Navigation Property name</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro4.png"/>
                </imageobject>
              </mediaobject>
            </figure>
            <para>Typically, here is where you will:</para>
            <itemizedlist mark="bullet">
              <listitem>
                <para>Select the entity at each end of the association 
</para>
              </listitem>
              <listitem>
                <para>Select the multiplicity of each end of the association, and 
</para>
              </listitem>
              <listitem>
                <para>Provide suitable names for the association and its navigation properties
</para>
              </listitem>
            </itemizedlist>
          </listitem>
          <listitem>
            <para>Once you then hit OK the diagram is refreshed to include the newly created association.
    </para>
            <figure xml:id="mpro5" floatstyle="1">
              <title>diagram</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro5.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>You now need to edit the mappings associated with the newly created association, so right-click the association on
the diagram, and select Table Mapping to display the Mapping Details pane.
    </para>
            <figure xml:id="mpro6" floatstyle="1">
              <title>Table Mapping</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro6.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Click that line reading &lt;Add a Table or View&gt; to reveal a drop down list of all entities.
    </para>
            <figure xml:id="mpro7" floatstyle="1">
              <title>Add a Table or View</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro7.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Here you need to select the entity on the right/far side of the association (the entity where
the foreign key exists). In this example, it is the Invoice entity.
    </para>
            <figure xml:id="mpro8" floatstyle="1">
              <title>Entity</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro8.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>The Mapping Details pane now refreshes to display both ends of the association, requiring that
you provide relevant target store data types in the Column column for the key fields, as depicted here.
    </para>
            <figure xml:id="mpro9" floatstyle="1">
              <title>Mapping Details</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro9.png"/>
                </imageobject>
              </mediaobject>
            </figure>
            <figure xml:id="mpro10" floatstyle="1">
              <title>Mapping Details</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro10.png"/>
                </imageobject>
              </mediaobject>
            </figure>
            <figure xml:id="mpro11" floatstyle="1">
              <title>Mapping Details</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro11.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Once the mapping is complete, you can build the project using Build -&gt; Build Solution. NOTE:
It is worthwhile building as each association is made, since the error messages can be a little confusing.
    </para>
            <figure xml:id="mpro12" floatstyle="1">
              <title>Build the project</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro12.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>This should result in the following error:
    </para>
            <figure xml:id="mpro13" floatstyle="1">
              <title>Error</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro13.png"/>
                </imageobject>
              </mediaobject>
            </figure>
            <para>This error indicates that there are two source columns - in this case, the Invoice entity's
Scalar Property Cust_Num and Navigation Property Customer, which are both mapped to the same target
column - the Progress column Invoice.Cust_Num - and this is not supported.</para>
            <figure xml:id="mpro14" floatstyle="1">
              <title>Error</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro14.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>The solution is simple! Simply delete the mapping of the Scalar Property Invoice.Cust_Num,
since its only purpose is to hold data representing a relationship/association (it is a Foreign Key)
which has already been represented by the newly created association and resulting Navigation Property
Customer.
    </para>
            <para>Right click on Invoice.Cust_Num then Delete.</para>
            <figure xml:id="mpro15" floatstyle="1">
              <title>delete the mapping</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro15.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>The model diagram will refresh to reflect this change.
    </para>
            <figure xml:id="mpro16" floatstyle="1">
              <title>Model Diagram</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro16.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>Build the project, again, using Build -&gt; Build Solution.
    </para>
            <figure xml:id="mpro17" floatstyle="1">
              <title>Build project</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro17.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
          <listitem>
            <para>The project should now be fine.
    </para>
            <figure xml:id="mpro18" floatstyle="1">
              <title>Build Project</title>
              <mediaobject>
                <imageobject>
                  <imagedata fileref="ui/mpro18.png"/>
                </imageobject>
              </mediaobject>
            </figure>
          </listitem>
        </orderedlist>
        <para>You will need to repeat these steps for each association until you have a completed
Entity Data Model.</para>
        <figure xml:id="mpro19" floatstyle="1">
          <title>Entity Data Model</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="ui/mpro19.png"/>
            </imageobject>
          </mediaobject>
        </figure>
      </section>
      <section xml:id="vdbenginepredcr">
        <title>Using EDM to create Entity Framework based applications</title>
        <para>Now that a Microsoft Entity Data Model has been created for the Progress isports database,
Entity Framework applications can be created to make use of it.</para>
        <section xml:id="vdbenginepredcrfr">
          <title>Entity Framework Data Service</title>
          <para>An ADO.Net Data Service for the Progress tables can be created using the Entity Data Model
created in the <link linkend="vdbengineprcrem">Creating EDM in Visual Studio 2008 section</link>

  .</para>
          <orderedlist>
            <listitem>
              <para>Open the </para>
              <para>
                <emphasis>VirtuosoDataService</emphasis>
              </para>
              <para> project created in the 
              <link linkend="vdbengineprcrem">Creating EDM in Visual Studio 2008 section</link>
              .
  </para>
            </listitem>
            <listitem>
              <para>Select the Project -&gt; Add New Item menu option.
    </para>
              <figure xml:id="fpro1" floatstyle="1">
                <title>VirtuosoDataService</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/einf4.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>The </para>
              <para>
                <emphasis>Add New Item</emphasis>
              </para>
              <para> dialog will appear. Choose the
</para>
              <para>
                <emphasis>ADO.NET Data Service template</emphasis>
              </para>
              <para>. Give it the name </para>
              <para>
                <emphasis>WebDataService.svc</emphasis>
              </para>
              <para>, and
click </para>
              <para>
                <emphasis>Add</emphasis>
              </para>
              <para> to create the ADO.Net Data Service.
    </para>
              <figure xml:id="fpro2" floatstyle="1">
                <title>Add New Item</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/fpro2.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>In the </para>
              <para>
                <emphasis>WebDataService1.svc.cs</emphasis>
              </para>
              <para> Data Service file created add the data source
class name of </para>
              <para>
                <emphasis>isportsEntities </emphasis>
              </para>
              <para> (note this is the name set in the
Creating EDM in Visual Studio 2008 section) as the </para>
              <para>
                <emphasis>DataService</emphasis>
              </para>
              <para> name and
enable the access to the Data Service by adding the entry
</para>
              <para>
                <emphasis>config.SetEntitySetAccessRule("*", EntitySetRights.All);</emphasis>
              </para>
              <para> in the </para>
              <para>
                <emphasis>InitializeService</emphasis>
              </para>
              <para> method.
</para>
              <programlisting>
// C#

using System;
using System.Web;
using System.Collections.Generic;
using System.ServiceModel.Web;
using System.Linq;
using System.Data.Services;

namespace SimpleDataService
{
    public class Northwind : DataService&lt;VirtuosoDemoEntities&gt;
    {
        public static void InitializeService(IDataServiceConfiguration  config)
        {
            config.SetEntitySetAccessRule("*", EntitySetRights.All);
        }
    }
}

</programlisting>
              <figure xml:id="fpro3" floatstyle="1">
                <title>WebDataService1.svc.cs</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/fpro3.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>To test the Data Service, simply hit </para>
              <para>
                <emphasis>Ctrl+F5</emphasis>
              </para>
              <para> within Visual Studio.
This will start the development web server, run the Data Services server inside and load a Web browser
page displaying the list of available tables/entities for the isports database catalog.
    </para>
              <figure xml:id="fpro4" floatstyle="1">
                <title>Data Service test</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/fpro4.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>To access a specific entity instance like the </para>
              <para>
                <emphasis>EMPLOYEES</emphasis>
              </para>
              <para> table employee
number </para>
              <para>
                <emphasis>100</emphasis>
              </para>
              <para> record, use this convention http://host/vdir/Virtuoso.svc/EMPLOYEES(100)  .
    </para>
              <figure xml:id="fpro5" floatstyle="1">
                <title>EMPLOYEES</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/fpro5.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
          </orderedlist>
          <para>
            <emphasis>Notes:</emphasis>
          </para>
          <orderedlist>
            <listitem>
              <para>
                <emphasis>Important</emphasis>
              </para>
              <para> - To view </para>
              <para>
                <emphasis>Atom</emphasis>
              </para>
              <para> (the default format
returned by an ADO.NET Data Service) in Internet Explorer, you must first ensure that
</para>
              <para>
                <emphasis>Feed Reading View</emphasis>
              </para>
              <para> is turned </para>
              <para>
                <emphasis>off</emphasis>
              </para>
              <para>. This can be done on the
</para>
              <para>
                <emphasis>Content tab</emphasis>
              </para>
              <para> of </para>
              <para>
                <emphasis>Tools in Internet Options</emphasis>
              </para>
              <para>.</para>
            </listitem>
            <listitem>
              <para>If a Data Services entity instance URI page fails to load you can turn </para>
              <para>
                <emphasis>Verbose</emphasis>
              </para>
              <para>
errors on by adding </para>
              <para>
                <emphasis>config.UseVerboseErrors = true;</emphasis>
              </para>
              <para> in the
</para>
              <para>
                <emphasis>virtuoso.svc.cs InitializeService</emphasis>
              </para>
              <para> method to obtain more detailed information from the server as to why the page failed to load:
</para>
              <programlisting>
public static void InitializeService(IDataServiceConfiguration config)

{

config.UseVerboseErrors = true;

config.SetEntitySetAccessRule("*", EntitySetRights.All);

}
</programlisting>
            </listitem>
          </orderedlist>
        </section>
        <section xml:id="vdbenginepredcrvs">
          <title>Visual Studio Windows DataGrid Form Application</title>
          <para>This section details the steps required to create a simple Visual Studio 2008 Windows Form
application, with associated DataGridView control for displaying data in selected tables from the target
database.</para>
          <orderedlist>
            <listitem>
              <para>Launch the Visual Studio 2008 SP1 IDE.
    </para>
              <figure xml:id="dora1_01" floatstyle="1">
                <title>Visual Studio 2008 SP1 IDE</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora1.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Create a </para>
              <para>
                <emphasis>Web Application</emphasis>
              </para>
              <para> project by going to the </para>
              <para>
                <emphasis>File</emphasis>
              </para>
              <para>
menu in Visual Studio and choosing </para>
              <para>
                <emphasis>New Project</emphasis>
              </para>
              <para>.

</para>
              <figure xml:id="epro2_03" floatstyle="1">
                <title>Web Application
</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/epro2.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>When the New Project window appears, choose either </para>
              <para>
                <emphasis>Visual Basic</emphasis>
              </para>
              <para> or
</para>
              <para>
                <emphasis>Visual C#</emphasis>
              </para>
              <para> as your programming language.</para>
            </listitem>
            <listitem>
              <para>Within the language category, click on </para>
              <para>
                <emphasis>Windows</emphasis>
              </para>
              <para> and select
</para>
              <para>
                <emphasis>Windows Form Application</emphasis>
              </para>
              <para> from the right-hand panel.</para>
            </listitem>
            <listitem>
              <para>Choose a name for the project, for example </para>
              <para>
                <emphasis>VirtWindowsFormApplication</emphasis>
              </para>
              <para>,
and click </para>
              <para>
                <emphasis>OK</emphasis>
              </para>
              <para>.
  </para>
              <figure xml:id="dora2_01" floatstyle="1">
                <title>Web Application</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora2.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>In the </para>
              <para>
                <emphasis>Toolbox</emphasis>
              </para>
              <para>, expand </para>
              <para>
                <emphasis>Data Controls</emphasis>
              </para>
              <para>, and drag the
</para>
              <para>
                <emphasis>DataGridView</emphasis>
              </para>
              <para> control onto the form.
    </para>
              <figure xml:id="dora3_01" floatstyle="1">
                <title>Toolbox</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora3.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Click on the little </para>
              <para>
                <emphasis>arrow</emphasis>
              </para>
              <para> in the top right of the </para>
              <para>
                <emphasis>DataGridView</emphasis>
              </para>
              <para> control.
This loads the </para>
              <para>
                <emphasis>DataGridView Task</emphasis>
              </para>
              <para> menu.
    </para>
              <figure xml:id="dora4_01" floatstyle="1">
                <title>DataGridView Task</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora4.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Click on the </para>
              <para>
                <emphasis>Choose Data Source</emphasis>
              </para>
              <para> list box.
    </para>
              <figure xml:id="dora5_01" floatstyle="1">
                <title>Choose Data Source</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora5.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Click on the </para>
              <para>
                <emphasis>Add Project Data Source</emphasis>
              </para>
              <para> link to connect to a data source.
    </para>
              <figure xml:id="dora6_01" floatstyle="1">
                <title>Add Project Data Source</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora6.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>In the </para>
              <para>
                <emphasis>Data Source Configuration Wizard</emphasis>
              </para>
              <para> dialog
</para>
              <para>
                <emphasis>Choose Data Source Type</emphasis>
              </para>
              <para> page select the </para>
              <para>
                <emphasis>Database</emphasis>
              </para>
              <para> data source type and click </para>
              <para>
                <emphasis>Next</emphasis>
              </para>
              <para>.
    </para>
              <figure xml:id="dora7_01" floatstyle="1">
                <title>Data Source Type</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora7.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>In the </para>
              <para>
                <emphasis>Data Source Configuration Wizard</emphasis>
              </para>
              <para> dialog
</para>
              <para>
                <emphasis>Choose your Data Connection</emphasis>
              </para>
              <para> page, select the </para>
              <para>
                <emphasis>New Connection</emphasis>
              </para>
              <para> button
    </para>
              <figure xml:id="dora8_01" floatstyle="1">
                <title>Data Source Configuration Wizard</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora8.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>In the </para>
              <para>
                <emphasis>Choose Data Source</emphasis>
              </para>
              <para> dialog, select the OpenLink
</para>
              <para>
                <emphasis>Virtuoso Data Source</emphasis>
              </para>
              <para> from the list and click </para>
              <para>
                <emphasis>Continue</emphasis>
              </para>
              <para>.
    </para>
              <figure xml:id="dora9_01" floatstyle="1">
                <title>Data Source</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora9.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>In the </para>
              <para>
                <emphasis>Add Connection</emphasis>
              </para>
              <para> dialog, specify the
</para>
              <para>
                <emphasis>hostname, portno, username and password</emphasis>
              </para>
              <para> for the target Virtuoso Server and check the Save Password check box.
    </para>
              <figure xml:id="dora10_03" floatstyle="1">
                <title>Connection Properties</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora10.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Select the </para>
              <para>
                <emphasis>Select Database From List</emphasis>
              </para>
              <para> radio button and choose
</para>
              <para>
                <emphasis>isports</emphasis>
              </para>
              <para> from the drop down list.
    </para>
              <figure xml:id="dora11p" floatstyle="1">
                <title>Add conneciton</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora11p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Press the </para>
              <para>
                <emphasis>Test Connection</emphasis>
              </para>
              <para> dialog to verify that the database is accessible.
    </para>
              <figure xml:id="dora12_01" floatstyle="1">
                <title>Test Connection</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora12.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Leave the default connect string </para>
              <para>
                <emphasis>isportsConnectionString</emphasis>
              </para>
              <para> and click </para>
              <para>
                <emphasis>Next</emphasis>
              </para>
              <figure xml:id="dora13p" floatstyle="1">
                <title>isportsConnectionString</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora13p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>From the list of available tables returned for the isports database, select the </para>
              <para>
                <emphasis>JOBS</emphasis>
              </para>
              <para>
table to be associated with the </para>
              <para>
                <emphasis>DataGridView</emphasis>
              </para>
              <para> control.
    </para>
              <figure xml:id="dora14p" floatstyle="1">
                <title>isports  database</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora14p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>The columns names of the select table will be displayed in the DataGridView.
    </para>
              <figure xml:id="dora15p" floatstyle="1">
                <title>DataGridView</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora15p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Resize the Form and DataGridView to allow all columns to be visible, if possible.
    </para>
              <figure xml:id="dora16p" floatstyle="1">
                <title>Resize the Form and DataGridView</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora16p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>To test the application, simply hit </para>
              <para>
                <emphasis>Ctrl+F5</emphasis>
              </para>
              <para> within Visual Studio or
select </para>
              <para>
                <emphasis>Start Debugging</emphasis>
              </para>
              <para> from the </para>
              <para>
                <emphasis>Debug</emphasis>
              </para>
              <para> menu.
    </para>
              <figure xml:id="dora17_01" floatstyle="1">
                <title>Start Debugging</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora17.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>The data from the </para>
              <para>
                <emphasis>JOBS</emphasis>
              </para>
              <para> table will be displayed in the </para>
              <para>
                <emphasis>DataGrid</emphasis>
              </para>
              <para>.
    </para>
              <figure xml:id="dora18p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora18p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>To make the DataGridView updateable, you will need to manually add some code to the
project along with a suitable control to invoke the code. Drag a Button control onto the form.
    </para>
              <figure xml:id="dora19p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora19p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Right click on the Button and select Properties.
    </para>
              <figure xml:id="dora20p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora20p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>In the Properties view, edit the buttons Text property to read Save Changes and its (Name) property to read saveChanges.
    </para>
              <figure xml:id="dora21p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora21p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>The button will now update to reflect these changes.
    </para>
              <para>NOTE: You will need to resize the button to make the new text visible.</para>
              <figure xml:id="dora22p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora22p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Double click the new button to generate the required event handler. It should take you directly to the area of code that will execute when the button is clicked.
    </para>
              <figure xml:id="dora23p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora23p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Edit the saveChanges_Click event handler code to include the following line.
</para>
              <programlisting>
private void saveChanges_Click(object sender, EventArgs e)
{
  this.msgsTableAdapter.Update(this.isportsDataSet.msgs);
}
</programlisting>
              <figure xml:id="dora24p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora24p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>Now test the application again by hitting Ctrl+F5.
    </para>
              <para>Scroll to the empty row, at the bottom, and enter data for a new row then select Save Changes which will write the new row back to the database.</para>
              <para>Updates and deletes can be performed similarly. </para>
              <figure xml:id="dora25p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora25p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
            <listitem>
              <para>You can use Interactive ISQL to test that the changes that have been written. Interactive ISQL Interface is detailed in the 
              <link linkend="vdbengineprlnk">Linking Progress tables</link>
               section.
    </para>
              <figure xml:id="dora26p" floatstyle="1">
                <title>DataGrid</title>
                <mediaobject>
                  <imageobject>
                    <imagedata fileref="ui/dora26p.png"/>
                  </imageobject>
                </mediaobject>
              </figure>
            </listitem>
          </orderedlist>
          <para>The task is now complete.</para>
        </section>
      </section>
    </section>
