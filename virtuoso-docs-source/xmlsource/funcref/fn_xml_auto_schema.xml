<?xml version="1.0" encoding="UTF-8"?>
<refentry xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://docbook.org/ns/docbook" xml:id="fn_xml_auto_schema">
      <refmeta>
        <refentrytitle>xml_auto_schema
</refentrytitle>
        <refmiscinfo>xml
</refmiscinfo>
      </refmeta>
      <refnamediv>
        <refname>xml_auto_schema
</refname>
        <refpurpose>returns an XML schema for the result of an SQL query with a FOR XML clause
</refpurpose>
      </refnamediv>
      <refsynopsisdiv>
        <funcsynopsis xml:id="fsyn_xml_auto_schema">
          <funcprototype xml:id="fproto_xml_auto_schema">
            <funcdef>varchar 
<function>xml_auto_schema
</function>

</funcdef>
            <paramdef choice="opt">in 
<parameter>query
</parameter>

   varchar
</paramdef>
            <paramdef choice="opt">in 
<parameter>root_element
</parameter>

   varchar
</paramdef>
          </funcprototype>
        </funcsynopsis>
      </refsynopsisdiv>
      <refsect1 xml:id="desc_xml_auto_schema">
        <title>Description
</title>
        <para>
This function returns an XML schema for the results of an SQL query
with a FOR XML clause. The returned schema will apply to the output
generated by <function>xml_auto()</function>

   with the query in
question after wrapping it in the specified root element.

</para>
      </refsect1>
      <refsect1 xml:id="params_xml_auto_schema">
        <title>Parameters
</title>
        <refsect2>
          <title>query
</title>
          <para>SQL query
</para>
        </refsect2>
        <refsect2>
          <title>root_element
</title>
          <para>name of root element container
</para>
        </refsect2>
      </refsect1>
      <refsect1 xml:id="ret_xml_auto_schema">
        <title>Return Types
</title>
        <para>varchar result containing the
schema of the XML document.
</para>
      </refsect1>
      <refsect1 xml:id="errors_xml_auto_schema">
        <title>Errors
</title>
        <para>If the 
<parameter>query
</parameter>

   argument is not a valid SQL statement, i.e. SQL compiler signals an error message,
                   the function resignals the error.

</para>
      </refsect1>
      <refsect1 xml:id="examples_xml_auto_schema">
        <title>Examples
</title>
        <example xml:id="ex_xml_auto_achema">
          <title>Simple Schema Generation
</title>
          <programlisting>
SQL&gt; select xml_auto_schema ('  select "category"."CategoryID", "CategoryName",
		"ProductName", "ProductID"
	from "Demo".."Categories" "category", "Demo".."Products" as "product"
	where "product"."CategoryID" = "category"."CategoryID"
	for xml auto element', 'root');
 callret
VARCHAR
_______________________________________________________________________________

&lt;xsd:schema xmlns:xsd="http://www.w3.org/1999/XMLSchema"&gt;

 &lt;xsd:annotation&gt;
  &lt;xsd:documentation&gt;
   Schema for output of the following SQL statement:
   &lt;[CDATA[  select "category"."CategoryID",
     "CategoryName", "ProductName", "ProductID"
     from "Demo".."Categories" "category",
     "Demo".."Products" as "product"
     where "product"."CategoryID" = "category"."CategoryID"
     for xml auto element]]&gt;
  &lt;/xsd:documentation&gt;
 &lt;/xsd:annotation&gt;

 &lt;xsd:element name="root" type="root__Type"/&gt;

 &lt;xsd:complexType name="root__Type"&gt;
  &lt;xsd:element name="category" type="category_Type"
  minOccurs="0" maxOccurs="unbounded"/&gt;
 &lt;/xsd:complexType&gt;

 &lt;xsd:complexType name="category_Type"&gt;
  &lt;xsd:element name="CategoryID" type="xsd:int" precision="10"/&gt;
  &lt;xsd:element name="CategoryName" type="xsd:string" maxLength="15"/&gt;
  &lt;xsd:element name="product" type="product_Type" minOccurs="0" maxOccurs="unbounded"/&gt;
 &lt;/xsd:complexType&gt;

 &lt;xsd:complexType name="product_Type"&gt;
  &lt;xsd:element name="ProductName" type="xsd:string" maxLength="40"/&gt;
  &lt;xsd:element name="ProductID" type="xsd:int" precision="10"/&gt;
 &lt;/xsd:complexType&gt;

&lt;/xsd:schema&gt;

1 Rows. -- 5 msec.

</programlisting>
        </example>
      </refsect1>
      <refsect1 xml:id="seealso_xml_auto_schema">
        <title>See Also
</title>
        <para>
          <link linkend="fn_xml_auto">
            <function>xml_auto()
</function>
          </link>
        </para>
        <para>
          <link linkend="fn_xml_auto_dtd">
            <function>xml_auto_dtd()
</function>
          </link>
        </para>
      </refsect1>
    </refentry>
