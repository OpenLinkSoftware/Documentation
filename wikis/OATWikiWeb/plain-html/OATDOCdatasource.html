<html><body><div class="topic-text"><!--Begin of %META:TOPICPARENT{name="OATDOCIndex"}%--><p> </p>
<!--End of %META:TOPICPARENT{name="OATDOCIndex"}%--><p> </p>
<h1><a name="datasource.js"></a> datasource.js</h1>
<p>Is an Ajax Database Connectivity (ADBC) layer.
 Provides data access support for various data sources (SQL, SPARQL, SOAP, etc.) and allows binding and execution of callbacks upon data arrival.
 Data are fetched on demand and cached.</p>
<!--Begin of %TOC{}%--><p> </p><div class="MACRO_TOC">  <div class="wikitoc">   <ul> <li><a href="#Objects">Objects</a></li>
<ul><li><a href="#OAT.DataSource%28type%29">OAT.DataSource(type)</a></li> </ul><li><a href="#Properties">Properties</a></li><ul><li><a href="#OAT.DataSource%3A%3Aconnection">OAT.DataSource::connection</a></li> <li><a href="#OAT.DataSource%3A%3Aoptions">OAT.DataSource::options</a></li> <li><a href="#OAT.DataSource%3A%3AoutputFields">OAT.DataSource::outputFields</a></li> </ul><li><a href="#Methods">Methods</a></li><ul><li><a href="#OAT.DataSource%3A%3AbindRecord%28recordCallback%29">OAT.DataSource::bindRecord(recordCallback)</a></li> <li><a href="#OAT.DataSource%3A%3AbindPage%28pageCallback%29">OAT.DataSource::bindPage(pageCallback)</a></li> <li><a href="#OAT.DataSource%3A%3AbindFile%28fileCallback%29">OAT.DataSource::bindFile(fileCallback)</a></li> <li><a href="#OAT.DataSource%3A%3AbindEmpty%28emptyCallback%29">OAT.DataSource::bindEmpty(emptyCallback)</a></li> <li><a href="#OAT.DataSource%3A%3AbindHeader%28headerCallback%29">OAT.DataSource::bindHeader(headerCallback)</a></li> <li><a href="#OAT.DataSource%3A%3AadvanceRecord%28recordIndex%29">OAT.DataSource::advanceRecord(recordIndex)</a></li> </ul><li><a href="#Constants">Constants</a></li><ul><li><a href="#OAT.DataSourceData.TYPE_SQL">OAT.DataSourceData.TYPE_SQL</a></li> <li><a href="#OAT.DataSourceData.TYPE_SOAP">OAT.DataSourceData.TYPE_SOAP</a></li> <li><a href="#OAT.DataSourceData.TYPE_REST">OAT.DataSourceData.TYPE_REST</a></li> <li><a href="#OAT.DataSourceData.TYPE_SPARQL">OAT.DataSourceData.TYPE_SPARQL</a></li> <li><a href="#OAT.DataSourceData.TYPE_GDATA">OAT.DataSourceData.TYPE_GDATA</a></li> </ul><li><a href="#Examples">Examples</a></li><ul><li><a href="#REST%20Example">REST Example</a></li> <li><a href="#SQL%20Example">SQL Example</a></li> <li><a href="#SPARQL%20Example">SPARQL Example</a></li> <li><a href="#GData%20Example">GData Example</a></li> </ul><p>  </p></ul>  </div> </div>
<!--End of %TOC{}%--><h2><a name="Objects"></a> Objects</h2>
<h3><a name="OAT.DataSource(type)"></a> OAT.DataSource(type)</h3>
<p>Creates new <tt>DataSource<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/DataSource&parent=OATDOCdatasource" class="wikiword">?</a></tt> object.<tt>type</tt>is one of <tt>TYPE_constants</tt>.</p>
<h2><a name="Properties"></a> Properties</h2>
<h3><a name="OAT.DataSource::connection"></a> OAT.DataSource::connection</h3>
<p>Assigns an <tt>OAT.Connection</tt> object to this DataSource<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/DataSource&parent=OATDOCdatasource" class="wikiword">?</a>.</p>
<h3><a name="OAT.DataSource::options"></a> OAT.DataSource::options</h3>
<p>Object with various properties, dependent on DataSource<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/DataSource&parent=OATDOCdatasource" class="wikiword">?</a> <tt>TYPE_</tt>:     * <tt><b>TYPE_SQL</b></tt> </p>
<ul><li><tt> <b>query</b></tt> - SQL query </li>
<li><tt> <b>limit</b></tt> - cursor limit </li>
<li><tt> <b>cursortype</b></tt> - 0/1; 0 - snapshot, 1 - dynaset </li>
<li><tt><b>TYPE_SOAP</b></tt> </li>
<li><tt> <b>service</b></tt> - name of WSDL service </li>
<li><tt> <b>rootelement</b></tt> - name of root input WSDL element </li>
<li><tt> <b>inputobj</b></tt> - input WSDL object (see <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/OATDOCws" class="wikiword">ws.js</a> documentation for details) </li>
<li><tt><b>TYPE_REST</b></tt> ,<tt><b>TYPE_SPARQL</b></tt> , <tt><b>TYPE_GDATA</b></tt> </li>
<li><tt> <b>query</b></tt> - HTTP GET querystring </li>
<li><tt> <b>output</b></tt> - 0/1; 0 - xml, 1 = json </li>
<li><tt> <b>xpath</b></tt> - bool; how are outputFields specified? True = XPath expressions; False = node names</li>
</ul><h3><a name="OAT.DataSource::outputFields"></a> OAT.DataSource::outputFields</h3>
<p>List of wanted fields in fetched data.</p>
<h2><a name="Methods"></a> Methods</h2>
<h3><a name="OAT.DataSource::bindRecord(recordCallback)"></a> OAT.DataSource::bindRecord(recordCallback)</h3>
<p>Listens for new data records.
 When new record is available, <tt>recordCallback</tt> is executed with 2 arguments: <tt>record data</tt> and <tt>record index</tt>.</p>
<h3><a name="OAT.DataSource::bindPage(pageCallback)"></a> OAT.DataSource::bindPage(pageCallback)</h3>
<p>Listens for new data record pages.
 When new data page (record set) is available, <tt>pageCallback</tt> is executed with 2 arguments:<tt>page data</tt> and <tt>page index</tt>.</p>
<h3><a name="OAT.DataSource::bindFile(fileCallback)"></a> OAT.DataSource::bindFile(fileCallback)</h3>
<p>Listens for new data file.
 When new data file is available, <tt>fileCallback</tt> is executed with 1 argument: <tt>file contents</tt>.</p>
<h3><a name="OAT.DataSource::bindEmpty(emptyCallback)"></a> OAT.DataSource::bindEmpty(emptyCallback)</h3>
<p>Listens for empty dataset.
 When empty dataset arrives, <tt>emptyCallback</tt> is executed.</p>
<h3><a name="OAT.DataSource::bindHeader(headerCallback)"></a> OAT.DataSource::bindHeader(headerCallback)</h3>
<p>Listens for data header.
 When header arrives, <tt>headerCallback</tt> is executed with 1 argument: <tt>data header</tt>.</p>
<h3><a name="OAT.DataSource::advanceRecord(recordIndex)"></a> OAT.DataSource::advanceRecord(recordIndex)</h3>
<p>Advances through records.<tt>recordIndex</tt> must be an integer.</p>
<h2><a name="Constants"></a> Constants</h2>
<h3><a name="OAT.DataSourceData.TYPE_SQL"></a> OAT.DataSourceData.TYPE_SQL</h3>
<p>ToBeDone<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/ToBeDone&parent=OATDOCdatasource" class="wikiword">?</a></p>
<h3><a name="OAT.DataSourceData.TYPE_SOAP"></a> OAT.DataSourceData.TYPE_SOAP</h3>
<p>ToBeDone<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/ToBeDone&parent=OATDOCdatasource" class="wikiword">?</a></p>
<h3><a name="OAT.DataSourceData.TYPE_REST"></a> OAT.DataSourceData.TYPE_REST</h3>
<p>ToBeDone<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/ToBeDone&parent=OATDOCdatasource" class="wikiword">?</a></p>
<h3><a name="OAT.DataSourceData.TYPE_SPARQL"></a> OAT.DataSourceData.TYPE_SPARQL</h3>
<p>ToBeDone<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/ToBeDone&parent=OATDOCdatasource" class="wikiword">?</a></p>
<h3><a name="OAT.DataSourceData.TYPE_GDATA"></a> OAT.DataSourceData.TYPE_GDATA</h3>
<p>ToBeDone<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/ToBeDone&parent=OATDOCdatasource" class="wikiword">?</a></p>
<h2><a name="Examples"></a> Examples</h2>
<h3><a name="REST Example"></a> REST Example</h3>
<br><pre>var conn = new OAT.Connection(OAT.ConnectionData.TYPE_REST, {url:&quot;myfile.xml&quot;});

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_REST);
ds.connection = conn;
ds.options.output = 0; /* fetch result as XML */
ds.options.xpath = 1; /* outputFields are specified as XPATH expressions */
ds.outputFields = [&#39;//result/binding[@name=&quot;created&quot;]/node()/text()&#39;,
                                        &#39;//result/binding[@name=&quot;creator&quot;]/node()/text()&#39;,
                                        &#39;//result/binding[@name=&quot;item_title&quot;]/node()/text()&#39;,
                                        &#39;//result/binding[@name=&quot;url&quot;]/node()/text()&#39;];

var recordCallback = function(data, index) {
        alert(&#39;Data at index &#39; + index + &#39;:\n&#39; + data );
}
ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre><p> </p>
<h3><a name="SQL Example"></a> SQL Example</h3>
<br><pre>var conn = new OAT.Connection(OAT.ConnectionData.TYPE_XMLA, {dsn:&quot;DSN=Local_Instance&quot;,endpoint:&quot;/XMLA&quot;});

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_SQL);
ds.connection = conn;
ds.options.query = &quot;SELECT OrderID, CustomerID, EmployeeID FROM Demo.demo.Orders&quot;;

var recordCallback = function(data, index) {
        alert(&#39;Data at index &#39; + index + &#39;:\n&#39; + data );
}
ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre><p> </p>
<h3><a name="SPARQL Example"></a> SPARQL Example</h3>
<br><pre>var connection = new OAT.Connection(OAT.ConnectionData.TYPE_REST,{url:&quot;/sparql/&quot;});
var q = &quot;SELECT ?s, ?p, ?o FROM &lt;http://www.flickr.com/search/?q=rdf+semanticweb&amp;s=rec&gt; WHERE { ?s ?p ?o . }&quot;;

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_SPARQL);
ds.outputFields = [&#39;//result/binding[@name=&quot;s&quot;]/node()/text()&#39;,
   &#39;//result/binding[@name=&quot;p&quot;]/node()/text()&#39;,
   &#39;//result/binding[@name=&quot;o&quot;]/node()/text()&#39;];

ds.connection = connection;
ds.options.query = &quot;query=&quot;+encodeURIComponent(q)+&quot;&amp;format=xml&quot;;
ds.options.output = 0; /* fetch result as XML */
ds.options.xpath = 1; /* outputFields are specified as XPATH expressions */

var recordCallback = function(data, index) {
        alert(&#39;Data at index &#39; + index + &#39;:\n&#39; + data );
}
ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre><p> </p>
<h3><a name="GData Example"></a> GData Example</h3>
<br><pre>var conn = new OAT.Connection(OAT.ConnectionData.TYPE_REST, {url:&quot;gdata.xml&quot;});

var ds = new OAT.DataSource(OAT.DataSourceData.TYPE_GDATA);
ds.connection = conn;
ds.options.output = 0;
ds.options.xpath = 1;
ds.outputFields = [ &quot;//atom:feed/atom:entry/atom:title&quot; ];

var recordCallback = function(data, index) {
        alert(&#39;Data at index &#39; + index + &#39;:\n&#39; + data );
}

ds.bindRecord(recordCallback);
ds.advanceRecord(0);
</pre><p> <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/CategoryDocumentation" class="wikiword">CategoryDocumentation</a> <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/CategoryOAT" class="wikiword">CategoryOAT</a> <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/CategoryOpenSource" class="wikiword">CategoryOpenSource</a> CategoryToBeDone<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/OATWikiWeb/CategoryToBeDone&parent=OATDOCdatasource" class="wikiword">?</a></p>
</div></body></html>