<html><body><div class="topic-text"><!--Begin of %META:TOPICPARENT{name="ServerAgentAdministration"}%--><p> <br></p><!--End of %META:TOPICPARENT{name="ServerAgentAdministration"}%--><h1><a name="TDS-based Sybase &amp; Microsoft SQL Server Agent Administration"></a>TDS-based Sybase &amp; Microsoft SQL Server Agent Administration</h1>
<p>The TDS-based Agent has replaced the old-style DB-Lib- and CT-Lib-based Sybase and SQLServer Database Agents and Lite Drivers.</p><p>A number of environment variables may be used in configuring database clients.</p><h2><a name="Table 1.&#10; Default Rule Book settings"></a>Table 1.
 Default Rule Book settings</h2>

<table class="wikitable">
<tr><td align="center">  <strong>Rule Book Section &amp; parameters</strong>  </td><td align="center">  <strong>Default Rule Book Settings</strong>  </td><td align="center">  <strong>Notes</strong>  </td></tr>
<tr><td align="center">  <code>[Environment SQLServer 2000]</code>  </td><td align="center">  </td><td> The section name will vary with the agent version and database version.  </td></tr>
<tr><td align="center">  <code>FREETDSCONF</code>  </td><td align="center">  <code>/home/openlink/bin/freetds.conf</code>  </td><td align="center">  </td></tr>
<tr><td align="center">  <code>DSQUERY</code>  </td><td align="center">  <code>SQLSERVER</code>  </td><td> Tells the driver what section of the <code>freetds.conf</code> file applies to these connections.  </td></tr>
<tr><td align="center">  <code>TDSHOST</code>  </td><td align="center">  <code>sqlsrv</code>  </td><td> Tells the driver what host your SQL Server/Sybase instance is on.  </td></tr>
<tr><td align="center">  <code>TDSPORT</code>  </td><td align="center">  <code>1433</code>  </td><td> Tells the driver what port your SQL Server/Sybase instance listens to for incoming connections. SQL Server uses port 1433 by default; Sybase uses 4100.  </td></tr>
<tr><td align="center">  <code>TDSVER</code>  </td><td align="center">  <code>7.0</code>  </td><td> Tells the driver what version of TDS to use, based on the SQL Server version.  Refer to the table below.  </td></tr>
<tr><td align="center">  <code>SQLSERVER_CATALOG</code>  </td><td align="center">  <code>Y</code>  </td><td> </td></tr>
<tr><td align="center">  <code>CURSOR_SENSITIVITY</code>  </td><td align="center">  <code>LOW</code>  </td><td> You can set this to <code>HIGH</code> after loading <code>oplrvc.sql</code>. </td></tr>
</table>
<p>The <code>TDSVER</code> option above must be set correctly for connection to the desired database.
 Use the following table to find which.</p><h2><a name="Table 2.&#10; TDSVER settings"></a>Table 2.
 TDSVER settings</h2>

<table class="wikitable">
<tr><td>  <p><strong><code>TDSVER</code> or <code>-V</code> Value</strong>  </p></td><td>  <p><strong>Database Versions Supported</strong>  </p></td><td>  <p><strong>Actual TDS Protocol Version</strong>  </p></td></tr>
<tr><td align="center">  4.2  </td><td> Microsoft SQL Server 4.x, 6.x </td><td align="center">  4.2  </td></tr>
<tr><td align="center">  4.6  </td><td> Sybase SQL Server 4.x </td><td align="center">  4.2  </td></tr>
<tr><td align="center">  5.0  </td><td> Sybase ASE (Adaptive Server Enterprise) 11.x, 12.x, 15.x <br> Sybase ASA (Adaptive Server Anywhere) 7.x, 8.x, 9.x <br> Sybase SQL Anywhere 6.x, 10.x, 11.x <br> Sybase SQL Server 10.x, 11.x </td><td align="center">  5.0  </td></tr>
<tr><td align="center">  7.0  </td><td> Microsoft SQL Server 7.x </td><td align="center">  7.0  </td></tr>
<tr><td align="center">  8.0  </td><td> Microsoft SQL Server 2000 (v.8.x) </td><td align="center">  7.1  </td></tr>
<tr><td align="center">  9.0  </td><td> Microsoft SQL Server 2005 (v.9.x) </td><td align="center">  7.2  </td></tr>
<tr><td align="center">  10.0  </td><td> Microsoft SQL Server 2008 (v.10.x) </td><td align="center">  7.3  </td></tr>
</table>
<p> <br></p></div></body></html>