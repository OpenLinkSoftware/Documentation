<html><body><div class="topic-text"><!--Begin of %META:TOPICPARENT{name="InstallConfigJDBC"}%--><p> <br></p><!--End of %META:TOPICPARENT{name="InstallConfigJDBC"}%--><p> <br></p><h1><a name="Using UDA with JBoss 4.0.3 (Linux)"></a> Using UDA with JBoss 4.0.3 (Linux) </h1>
<!--Begin of %TOC{}%--><p> <br></p><div class="MACRO_TOC"> <br> <div class="wikitoc"> <br>  <ul> <br><li><a href="#Required%20components">Required components</a></li> <br><li><a href="#Install%20JDK">Install JDK</a></li> <br><li><a href="#Set%20Environment%20Variables">Set Environment Variables</a></li> <br><li><a href="#Install%20JBoss">Install JBoss</a></li> <br><li><a href="#Starting%20JBoss">Starting JBoss</a></li> <br><li><a href="#Install">Install</a></li> <br><li><a href="#Create%20the%20data%20sources%20file">Create the data sources file</a></li> <br><li><a href="#Prepare%20the%20Web%20Application">Prepare the Web Application</a></li><ul><li><a href="#Rename%20the%20.war%20file%20to%20.zip">Rename the .war file to .zip</a></li> <br><li><a href="#Edit%20JDBC%20URLs">Edit JDBC URLs</a></li> <br><li><a href="#Edit%20the%20SQL%20statement%28s%29">Edit the SQL statement(s)</a></li> <br><li><a href="#Rename%20the%20.zip%20file%20back%20to%20.war">Rename the .zip file back to .war</a></li> <br></ul>
<li><a href="#Deploy%20opltest%20Web%20Application">Deploy opltest Web Application</a></li>
<p>  </p></ul> <br> </div> <br></div><!--End of %TOC{}%--><h2><a name="Required components"></a> Required components </h2>
<p>You will need to download the following components</p><ul><li> JBoss - <a href="http://www.jboss.com" class="absuri">download</a> <br></li>
<li> JDK - <a href="http://java.sun.com" class="absuri">download</a> <br></li>
<li> opltest.war Web Application - <a href="http://wiki.usnet.private:8791/twiki/pub/Main/UDATomcatLinux/opltest.war|download" class="absuri">http://wiki.usnet.private:8791/twiki/pub/Main/UDATomcatLinux/opltest.war|download</a> <br></li>
<li> OpenLink<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/OpenLink&parent=JDBCAppServerJbosLinux" class="wikiword">?</a> jar file - one of these, appropriate to the selected JDK/JRE - <br>
<table class="wikitable">
<tr><td align="center">  <nop>*JDK/JRE/JVM*  </nop></td><td align="center">  *OpenLink<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/OpenLink&parent=JDBCAppServerJbosLinux" class="wikiword">?</a> JDBC Driver*  </td></tr>
<tr><td align="center">  1.1  </td><td align="center">  <a href="http://www.openlinksw.com/|opljdbc.jar" class="absuri">http://www.openlinksw.com/|opljdbc.jar</a>  </td></tr>
<tr><td align="center">  1.2 or 1.3  </td><td align="center">  <a href="http://www.openlinksw.com/|opljdbc2.jar" class="absuri">http://www.openlinksw.com/|opljdbc2.jar</a>  </td></tr>
<tr><td align="center">  1.4 or 1.5  </td><td align="center">  <a href="http://www.openlinksw.com/|opljdbc3.jar" class="absuri">http://www.openlinksw.com/|opljdbc3.jar</a>  </td></tr>
<tr><td align="center">  1.6  </td><td align="center">  <a href="http://www.openlinksw.com/|opljdbc4.jar" class="absuri">http://www.openlinksw.com/|opljdbc4.jar</a>  </td></tr>
<tr><td align="center">  1.7  </td><td align="center">  <a href="http://www.openlinksw.com/|opljdbc4_1.jar" class="absuri">http://www.openlinksw.com/|opljdbc4_1.jar</a>  </td></tr>
<tr><td align="center">  1.8  </td><td align="center">  <a href="http://www.openlinksw.com/|opljdbc4_2.jar" class="absuri">http://www.openlinksw.com/|opljdbc4_2.jar</a>  </td></tr>
</table>
</li>
</ul><p> <br></p><h2><a name="Install JDK"></a> Install JDK </h2>
<p>Install the JDK by running the *.bin, which automatically extracts the JDK.</p><p>NOTE: You may need to set the execute permission on the bin file before it can be executed.</p><p> <br></p><h2><a name="Set Environment Variables"></a> Set Environment Variables </h2>
<p>The following environment variables must be set -- <br><br></p><pre>  export JAVA_HOME=/usr/java/jre1.5.0_05
  export PATH=$PATH:/usr/java/jdk1.5.0_05/bin
</pre><p> <br>The simplest way is to add these to your -- <tt>~/.bash_profile=</tt> (or similar, depending on <strong><em>$SHELL</em></strong>) to ensure they are set every time you log in.</p><p>NOTE: Paths to your Java installation will most likely differ!</p><p> <br></p><h2><a name="Install JBoss"></a> Install JBoss </h2>
<p>Installing JBoss by running gunzip and tar against the downloaded <tt>*.tar.gz</tt> file which will extract the archive into the current working directory.
<br><br></p><pre>gunzip *.tar.gz
tar -xvf *.tar
</pre><p> <br>The root install directory of JBoss will be known as; <tt>$JBOSS_DIST</tt></p><p> <br></p><h2><a name="Starting JBoss"></a> Starting JBoss </h2>
<p>Start JBoss using the command -- <br><br></p><pre>$JBOSS_DIST/bin/run.sh
</pre><p> <br>Browse to the following url to verify that JBoss is up and running -- <br><br></p><pre>http://tomcat_server:8080
</pre><p> <br>NOTE: JBoss may take several minutes to start.</p><p> <br></p><h2><a name="Install"></a> Install OpenLink<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/OpenLink&parent=JDBCAppServerJbosLinux" class="wikiword">?</a> jar files </h2>
<p>Copy the <tt>.jar</tt> file chosen for your JDK/JVM/JRE <br>into the directory -- <br><tt>$JBOSS_DIST/server/default/lib</tt></p><p>Stop and restart JBoss with the commands -- <br><tt>Control-C will stop JBoss<br>$JBOSS_DIST/bin/run.sh</tt></p><p> <br></p><h2><a name="Create the data sources file"></a> Create the data sources file </h2>
<p>JBoss requires a special file to declare the data sources.</p><p>Create a new file -- <br><tt>$JBOSS_DIST/server/default/deploy/opltest-ds.xml</tt></p><p>to include the following data sources --<br></p><pre>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;

&lt;!--  Datasource config for OpenLink --&gt;

&lt;local-tx-datasource&gt;
  &lt;jndi-name&gt;jdbc/o32opljdbc1&lt;/jndi-name&gt;
  &lt;connection-url&gt;jdbc:openlink://192.168.0.150:5000/SVT=Odbc/Database=sqlserver/UID=sa/PWD=sa&lt;/connection-url&gt;
  &lt;driver-class&gt;openlink.jdbc.Driver&lt;/driver-class&gt;
  &lt;user-name&gt;sa&lt;/user-name&gt;
  &lt;password&gt;sa&lt;/password&gt;
&lt;/local-tx-datasource&gt;

&lt;local-tx-datasource&gt;
  &lt;jndi-name&gt;jdbc/m32opljdbc1&lt;/jndi-name&gt;
  &lt;connection-url&gt;jdbc:openlink://192.168.0.150:5000/SVT=SQLServer 2000/Database=Northwind/options=-H 192.168.0.150/UID=sa/PWD=sa&lt;/connection-url&gt;
  &lt;driver-class&gt;openlink.jdbc.Driver&lt;/driver-class&gt;
  &lt;user-name&gt;sa&lt;/user-name&gt;
  &lt;password&gt;sa&lt;/password&gt;
&lt;/local-tx-datasource&gt;

&lt;local-tx-datasource&gt;
  &lt;jndi-name&gt;jdbc/o32opljdbc2&lt;/jndi-name&gt;
  &lt;connection-url&gt;jdbc:openlink://192.168.0.150:5000/SVT=Odbc/Database=sqlserver/UID=sa/PWD=sa&lt;/connection-url&gt;
  &lt;driver-class&gt;openlink.jdbc2.Driver&lt;/driver-class&gt;
  &lt;user-name&gt;sa&lt;/user-name&gt;
  &lt;password&gt;sa&lt;/password&gt;
&lt;/local-tx-datasource&gt;

&lt;local-tx-datasource&gt;
  &lt;jndi-name&gt;jdbc/m32opljdbc2&lt;/jndi-name&gt;
  &lt;connection-url&gt;jdbc:openlink://192.168.0.150:5000/SVT=SQLServer 2000/Database=Northwind/options=-H 192.168.0.150/UID=sa/PWD=sa&lt;/connection-url&gt;
  &lt;driver-class&gt;openlink.jdbc2.Driver&lt;/driver-class&gt;
  &lt;user-name&gt;sa&lt;/user-name&gt;
  &lt;password&gt;sa&lt;/password&gt;
&lt;/local-tx-datasource&gt;

&lt;local-tx-datasource&gt;
  &lt;jndi-name&gt;jdbc/o32opljdbc3&lt;/jndi-name&gt;
  &lt;connection-url&gt;jdbc:openlink://192.168.0.150:5000/SVT=Odbc/Database=sqlserver/UID=sa/PWD=sa&lt;/connection-url&gt;
  &lt;driver-class&gt;openlink.jdbc3.Driver&lt;/driver-class&gt;
  &lt;user-name&gt;sa&lt;/user-name&gt;
  &lt;password&gt;sa&lt;/password&gt;
&lt;/local-tx-datasource&gt;

&lt;local-tx-datasource&gt;
  &lt;jndi-name&gt;jdbc/m32opljdbc3&lt;/jndi-name&gt;
  &lt;connection-url&gt;jdbc:openlink://192.168.0.150:5000/SVT=SQLServer 2000/Database=Northwind/options=-H 192.168.0.150/UID=sa/PWD=sa&lt;/connection-url&gt;
  &lt;driver-class&gt;openlink.jdbc3.Driver&lt;/driver-class&gt;
  &lt;user-name&gt;sa&lt;/user-name&gt;
  &lt;password&gt;sa&lt;/password&gt;
&lt;/local-tx-datasource&gt;

&lt;/datasources&gt;
</pre><p> <br>NOTE: You will need to amend URLs, usernames and passwords as appropriate.</p><p> <br></p><h2><a name="Prepare the Web Application"></a> Prepare the Web Application </h2>
<p>Demonstrating how to build and deploy a Web application from the beginning is beyond the scope of this short tutorial so what follows is a quick method of altering the JDBC URLs and SQL statements in an existing Web application.</p><p>NOTE: Be careful when moving .war files about using Internet Explorer.
 Sometimes they will be renamed to .zip by Internet Explorer.</p><h3><a name="Rename the .war file to .zip"></a> Rename the .war file to .zip </h3>
<p>Rename - <tt>opltest.war</tt> -to- <tt>opltest.zip</tt></p><p>You will then be able to unzip the archive to get at the files inside it.
 (Some utilities can unzip the .war archive without renaming.) <br><tt>unzip opltest.zip</tt></p><h3><a name="Edit JDBC URLs"></a> Edit JDBC URLs </h3>
<p>Edit the driver class and the JDBC connection URL in the file -- <br><tt>/META-INF/context.xml</tt></p><p>NOTE: Ensure that the edited file is placed back into the archive.
<br><tt>zip -r ../opltest *</tt></p><p> <br></p><h3><a name="Edit the SQL statement(s)"></a> Edit the SQL statement(s) </h3>
<p>You will need to edit the SQL statement(s) in <i>the following JSP files</i> based on the chosen database determined by the JDBC URL in the file -- <br><tt>/META-INF/context.xml</tt></p><p>Edit the JSP files -- <br><br></p><pre>opljdbc.jsp
opljdbc2.jsp 
opljdbc3.jsp
</pre><p> <br>There are two main areas of interest --</p><ol><li>The &lt;sql:query&gt; tag which select the datasource as defined in - <tt>/META-INF/context.xml</tt><br> <br>which contains the SQL query itself -- <br> <br><tt>&lt;sql:query var=&quot;resultset&quot; dataSource=&quot;jdbc/opljdbc2&quot;&gt;<br>		select SupplierID, CompanyName, ContactName, ContactTitle from Suppliers<br>	&lt;/sql:query&gt;</tt> <br>		<br> <br></li>
<li>The one or more ${row.column_name} constructs that output data as per the SQL query <br> <br><tt>${row.SupplierID}<br>${row.CompanyName} </tt></li>
</ol><p> <br>NOTE: Ensure that the edited file is placed back into the archive.
<br><tt>zip -r ../opltest *</tt></p><h3><a name="Rename the .zip file back to .war"></a> Rename the .zip file back to .war </h3>
<p>Rename the file <tt>opltest.zip</tt> back to <tt>opltest.war</tt></p><p> <br></p><h2><a name="Deploy opltest Web Application"></a> Deploy opltest Web Application </h2>
<p>Deploying on JBoss is simply a case of placing the Web application -- <br><tt>opltest.war</tt></p><p>into the following directory -- <br><tt>$JBOSS_DIST/server/default/deploy</tt></p><p>The newly deployed application is now available at the following URL -- <br><tt>http://jboss_server:8080/opltest</tt></p></div></body></html>