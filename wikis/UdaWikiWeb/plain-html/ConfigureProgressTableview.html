<html><body><div class="topic-text"><!--Begin of %META:TOPICPARENT{name="ConfigureUDAFeatures"}%--><p> <br></p><!--End of %META:TOPICPARENT{name="ConfigureUDAFeatures"}%--><p> <br></p><h1><a name="Advanced Features for Progress Connections: Distributed Databases, Array Fields, and Database Triggers"></a> Advanced Features for Progress Connections: Distributed Databases, Array Fields, and Database Triggers </h1>
<p>Our Progress <b>SQL-89</b> ODBC Drivers support a number of advanced features (referred to collectively as &quot;Tableview&quot; features) through the use of a custom &quot;Data Dictionary File.&quot;</p><p> <br><i><b>Tableview configuration cannot be supported in our SQL-92 drivers, due to changes made in the Progress Software components.
 Some features are still supported through different methods; others simply cannot be re-implemented (as of this writing).</b></i><!--Begin of %TOC{}%--><p> <br></p><div class="MACRO_TOC"> <br> <div class="wikitoc"> <br>  <ul> <br><li><a href="#Distributed%20Databases">Distributed Databases</a></li> <br><li><a href="#Array%20Fields">Array Fields</a></li> <br><li><a href="#Progress%20Database%20Triggers">Progress Database Triggers</a></li> <br><li><a href="#Setting%20Up%20Tableview%20Functionality%20for%20SQL-89%20Connections">Setting Up Tableview Functionality for SQL-89 Connections</a></li><ul><li><a href="#Advanced%20Tableview%20Configuration">Advanced Tableview Configuration</a></li> <br></ul>
<li><a href="#Troubleshooting%20Common%20Tableview%20Problems">Troubleshooting Common Tableview Problems</a></li>
<p>  </p></ul> <br> </div> <br></div><!--End of %TOC{}%--></p><h2><a name="Distributed Databases"></a> Distributed Databases </h2>
<p>This is the most common reason users need to configure Tableview features, with the SQL-89 drivers.
 There is no special configuration required here; just the basic Tableview Setup (below).</p><p>Due to changes made in the Progress database engine between their SQL-89 and SQL-92 engines, <code>JOINs</code> over multiple Progress databases (i.e., multiple <code>.db</code> files) cannot be executed over a single SQL-92 mode ODBC connection against Progress <nop></nop>OpenEdge 9.1x, 10.x, and later</p><p>According to the Progress SQL-92 documentation:</p><blockquote>An application can connect to more than one database at a time, with a maximum of 10 connections.
 However, the application can actually gain access to only one database at a time.
 The database name specified in the <code>CONNECT</code> statement becomes the active one.</blockquote>
<p>For this reason, if you need to make such queries, <nop></nop>OpenLink recommends you <br></p><ul><li> run Progress 9 in SQL-89 mode (perhaps in combination with SQL-92 mode; this &quot;hybrid&quot; operation is the default for Progress 9.x), and use the appropriate SQL-89 driver, permitting execution of these <code>JOINs</code> in the traditional manner; or <br></li>
<li> use Virtuoso and multiple single-DB SQL-92 connections to unify the Progress databases into a single Virtuoso schema, against which the <code>JOINs</code> may be executed.</li>
</ul><p> <br></p><h2><a name="Array Fields"></a> Array Fields </h2>
<p>Array fields are the second-most common reason users need to configure Tableview features.
 There is again no special configuration required with the SQL-89 drivers; just the basic Tableview Setup (below).</p><p>Progress array fields are not supported via the SQL-92 engine the same way they are via the traditional SQL-89 interface drivers.</p><p>Progress tables with array fields cannot be created while connected to the SQL-92 engine; however, array fields previously created using the SQL-89 driver may be accessed via the SQL-92 engine.</p><p>From a technical perspective, the array field is mapped to a single variable character (<code>VARCHAR</code>) field, and the data is returned as a semicolon-separated list.
 Individual elements of the array may be accessed using three Progress functions within SQL Statements:
</p><table class="wikitable">
<tr><td><p><strong>Progress function</strong> </p></td><td><p><strong>Effect</strong> </p></td></tr>
<tr><td><code>PRO_ELEMENT</code> </td><td>This function allows one or more elements to be selected. </td></tr>
<tr><td><code>PRO_ARR_ESCAPE</code> </td><td>This function simplifies escaping special characters when updating an array field. </td></tr>
<tr><td><code>PRO_ARR_DESCAPE</code> </td><td>This function removes escape characters from elements selected from an array field. </td></tr>
</table>
<p>For more information on this topic, visit Appendix C, section 2, of the <strong>SQL-92 Guide and Reference</strong>, in the Progress 9 documentation.
 (Exact location will be different in Progress <nop></nop>OpenEdge documentation.)</p><h2><a name="Progress Database Triggers"></a> Progress Database Triggers </h2>
<p>Progress Database Triggers are only supported over SQL-89-based connections.
 The SQL-92 engine has completely changed the way Progress Triggers work.</p><p><em><strong>Important:</strong> To make use of Progress Database Triggers, the Logical Database Name to which your Triggers have been compiled must match the value provided to the &quot;<code>-ld</code>&quot; parameter when setting the Progress Database Connect options during the execution of &quot;<code>setup.p</code>&quot;.</em></p><p>If you have compiled your triggers against a database physically identified as &quot;<code>/usr/progress/demo.db</code>&quot; but logically identified as &quot;<code>mydemo</code>&quot;, your &quot;<code>setup.p</code>&quot; Database Connection String (used below) would be: <br><br></p><pre>/usr/progress/demo -ld mydemo
</pre><p> <br></p><h2><a name="Setting Up Tableview Functionality for SQL-89 Connections"></a> Setting Up Tableview Functionality for SQL-89 Connections </h2>
<p>This custom &quot;Data Dictionary File&quot; is built by running the <nop></nop>OpenLink-provided Progress Program File &quot;<code>setup.p</code>&quot; found in the &quot;bin&quot; sub-directory below the <nop></nop>OpenLink base installation directory.
 Follow the instructions for your platform --</p><ul><li> <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/RunTableviewOnUnix" class="wikiword">Unix Host</a> <br></li>
<li> <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/RunTableviewOnWindows" class="wikiword">Windows Host</a></li>
</ul><p>Once the <code>setup.p</code> script has been run, follow the instructions to configure your driver type to use the resulting <code>tableview.pf</code> and <code>tableview.dat</code> files:</p><ul><li> <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/ConfigureSingle-TierToUseTableview" class="wikiword">Single-Tier</a> <br></li>
<li> <a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/ConfigureMulti-TierToUseTableview" class="wikiword">Multi-Tier</a></li>
</ul><h3><a name="Advanced Tableview Configuration"></a> Advanced Tableview Configuration </h3>
<p><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/WorkingWithMultipleSetsOfTableviewConfigurationFilesMulti-TierOnly" class="wikiword">Working with Multiple Sets of Tableview Configuration Files (Multi-Tier Only)</a></p><h2><a name="Troubleshooting Common Tableview Problems"></a> Troubleshooting Common Tableview Problems </h2>
<p><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/SetupiEnforces255CharFieldLimit" class="wikiword"><code>setup.i</code> Enforces 255 Char Field Limit</a> <br><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/TableviewDefaultAllowsOnly5Databases" class="wikiword">Tableview Default allows only 5 databases</a> <br></p></div></body></html>