<html><body><div class="topic-text"><!--Begin of %META:TOPICPARENT{name="VOSIndex"}%--><p> </p>
<!--End of %META:TOPICPARENT{name="VOSIndex"}%--><h2><a name="Virtuoso Default SPARQL 1.1 related Endpoint Vulnerability"></a> Virtuoso Default SPARQL 1.1 related Endpoint Vulnerability</h2>
<p>A vulnerability scenario has been discovered in the default <code>/sparql</code> endpoint of prior Virtuoso 7.2 releases, whereby despite defaulting to read-only access (using coarse-grained SQL ROLE based Security) certain SPARQL 1.1 INSERT &amp; DELETE operations are possible, contrary to the perception relayed by the following error message: </p>
<br><pre>Virtuoso 42000 Error SR186:SECURITY: No permission to execute procedure DB.DBA.SPARQL_DELETE_DICT_CONTENT with user ID {some-user-id}, group ID {some-sql-role-account-id}.
</pre><p>This issue has been resolved in the latest 7.2.4+ (3217+) build releases and available from the <a href="http://virtuoso.openlinksw.com/download/" class="absuri">Virtuoso Download</a> page.</p>
<p>For those running earlier releases the following SQL commands immediately secure existing instances, courtesy of Virtuoso&#39;s finer-grained Graph Security layer: </p>
<br><pre>DB.DBA.RDF_DEFAULT_USER_PERMS_SET (&#39;nobody&#39;, 0, 1); -- nobody has no access to private named graphs
DB.DBA.RDF_DEFAULT_USER_PERMS_SET (&#39;nobody&#39;, 1, 0); -- &#39;nobody&#39; can only read public named graphs
</pre><p>Note this workaround has performance impact and can be disabled following upgrade to the new 7.2.4+ (3217+) binary.
If you simply want to secure a specific named graph, you can issue the following: </p>
<br><pre>DB.DBA.RDF_GRAPH_GROUP_INS
(&#39;http://www.openlinksw.com/schemas/virtrdf#PrivateGraphs&#39;,&#39;{named-graph-iri}&#39;)
;
</pre></div></body></html>