<docbook><section><title>VirtSparqlCxmlFacetPivotBridgeHtml</title><para> </para>
<title>Pivot Collections (Part 6)</title>Pivot Collections (Part 6)
<bridgehead class="http://www.w3.org/1999/xhtml:h2">Contents</bridgehead>
<para>Part 1: <ulink url="VirtSparqlCxmlHtml">Introduction</ulink></para>
<para>Part 2: <ulink url="VirtSparqlCxmlHtml">SparqlCxml</ulink></para>
<para>Part 3: <ulink url="VirtSparqlCxmlDzcsHtml">SparqlCxml Deep Zoom Collections</ulink></para>
<para>Part 4: <ulink url="VirtSparqlCxmlHtmlPivotViewer">HtmlPivotViewer</ulink></para>
<para>Part 5: <ulink url="VirtSparqlCxmlImportHtml">Importing CXML</ulink></para>
<para>Part 6: Facet Pivot Bridge</para>
<itemizedlist mark="bullet" spacing="compact"><listitem><ulink url="#AncSparqlCxmlFacetPivotBridge"><span style="color: red">
      UNKNOWN tag:
      http://www.w3.org/1999/xhtml:nowikiFacet Pivot Bridge</span></ulink> <itemizedlist mark="bullet" spacing="compact"><listitem><ulink url="#AncFpbOverview">Overview</ulink> </listitem>
<listitem><ulink url="#AncFpbCxmlTailoring">Tailoring the CXML Output</ulink> </listitem>
<listitem><ulink url="#AncFpbPagedCollections">Paged Collections</ulink> </listitem>
<listitem><ulink url="#AncFpbLimits">Limits</ulink> <itemizedlist mark="bullet" spacing="compact"><listitem><ulink url="#AncMaxCxmlFileSize">Maximum CXML File Size</ulink> </listitem>
<listitem><ulink url="#AncMaxSortedTopRows">Collection Truncation &amp; MaxSortedTopRows</ulink></listitem>
</itemizedlist></listitem>
</itemizedlist></listitem>
</itemizedlist><para>Part 7: <ulink url="VirtSparqlCxmlDETsHtml">DETs : Persisting SPARQL Query Results to DAV</ulink></para>
<para>Part 8: <ulink url="VirtSparqlCxmlFAQsHtml">Frequently Asked Questions (FAQs)</ulink></para>
<para>Part 9: <ulink url="VirtSparqlCxmlGlossaryHtml">Glossary</ulink></para>
<para> <ulink url="">
 </ulink></para>
<bridgehead class="http://www.w3.org/1999/xhtml:h2">Facet Pivot Bridge</bridgehead>
<para>The Facet Pivot Bridge provides one alternative to the /sparql endpoint and Conductor /sparql UI for CXML generation.
 It presents a more user-friendly front end for users unfamiliar with SPARQL or not wanting to use it directly.
 As its name suggests, it forms a bridge between Virtuoso&#39;s <ulink url="http://docs.openlinksw.com/virtuoso/virtuosospongerfacetinstall.html">Facet Browser</ulink> and Pivot Viewer, through which Pivot collections can be generated directly from search results returned by the <ulink url="http://docs.openlinksw.com/virtuoso/virtuosospongerfacent.html">Facets Web Service</ulink>.</para>
<ulink url="">
<para> </para>
<bridgehead class="http://www.w3.org/1999/xhtml:h3">Overview</bridgehead>
<para>The screenshot below shows the standard Facet Browser start screen displayed by the Faceted Search service at /fct.
 On entering some search text, for example &quot;CEO&quot;, and clicking &quot;Search&quot;, the Facet Browser displays all entities in the host RDF quad store with any attribute containing the specified text.</para>
<figure><graphic fileref="VirtSparqlCxmlFacetPivotBridgeHtml/fct_ceo_search_text.jpg" /></figure><para>If the Facet Pivot Bridge VAD is installed, the result page includes a &#39;Make Pivot Collection&#39; link for generating a CXML snapshot of the results.
 When clicked, the Bridge automatically redirects to PivotViewer to display the resulting collection.
 Adjacent to the &#39;Make Pivot Collection&#39; link are controls for tailoring the collection.
 Large collections can be split into pages, a QRcode (matrix bar code) can be included alongside each item&#39;s image and URIs can be typed as CXML Strings or Links.</para>
<para> <figure><graphic fileref="VirtSparqlCxmlFacetPivotBridgeHtml/fpb_results.jpg" /></figure> <ulink url="VirtSparqlCxmlFacetPivotBridgeHtml/fpb_results.jpg">Click to enlarge</ulink></para>
<para>Collections generated by the Bridge are saved to a file named collection_{timestamp}.cxml and placed in virtual directory http://&lt;hostname&gt;/pivot_collections/.
 The virtual directory maps to the WebDAV folder DAV/pivot_collections.
 So, the full URI to display a Bridge-created collection in PivotViewer would be something like: </para>
<itemizedlist mark="bullet" spacing="compact"><listitem>http://linkeddata.uriburner.com/PivotViewer/?url=http://linkeddata.uriburner.com/pivot_collections/collection_2010-12-23_16-55-48.cxml</listitem>
</itemizedlist><ulink url="">
<para> </para>
<bridgehead class="http://www.w3.org/1999/xhtml:h3">Tailoring the CXML Output</bridgehead>
<para>The Facet Pivot Bridge is built atop SparqlCxml.
 However, because the bridge shields users from the complexities of SPARQL, much of the flexibility of SparqlCxml for controlling the CXML output is necessarily lost.
 Internally, the bridge uses SPARQL DESCRIBEs rather than SELECTs for CXML generation.
 Consequently the same restrictions apply as discussed in the comparison of these two query types in section SparqlCxml.
 Specifically, adjusting the RDF to CXML mapping through SPARQL SELECT reserved query variables is not possible.
 All customisation of the CXML output must be done through graph virtcxml:</para>
<ulink url="">
<para> </para>
<bridgehead class="http://www.w3.org/1999/xhtml:h3">Paged Collections</bridgehead>
<para>When a collection is split into pages, links to the first, last, next and previous pages are displayed under the &#39;Related Collections&#39; section of PivotViewer&#39;s Info Panel.
 Depending on the current page position, some of these links may not be displayed.
 For instance the first and previous links will not be shown if you are already viewing the first page.</para>
<figure><graphic fileref="VirtSparqlCxmlFacetPivotBridgeHtml/fpb_page_links.jpg" /></figure><ulink url="">
<para> </para>
<bridgehead class="http://www.w3.org/1999/xhtml:h3">Limits</bridgehead>
<ulink url="">
<para> </para>
<bridgehead class="http://www.w3.org/1999/xhtml:h4">Maximum CXML File Size</bridgehead>
<para>Experience has shown that the <ulink url="VirtSparqlCxmlHtmlPivotViewer">HtmlPivotViewer</ulink> control can struggle to handle large CXML files.
 To avoid browser hangs, the Bridge checks the size of a generated CXML file before serving it to PivotViewer.
 It will report an error if the file size exceeds the configured maximum.
 By default, this is set to 5MB.
 To adjust this limit, change the PVT_MAX_CXML_FILE_SIZE entry in the Facet Pivot Bridge configuration table DB.DBA.PIVOT_CFG.</para>
<ulink url="">
<para> </para>
<bridgehead class="http://www.w3.org/1999/xhtml:h4">Collection Truncation &amp; MaxSortedTopRows</bridgehead>
<para>In order to support paged Pivot collections, a faceted search on the free text &quot;CEO&quot; might result in the Facet Pivot Bridge constructing a query similar to: </para>
<programlisting>describe ?s1 where { { select distinct ?s1 where { ?s1 a ?concept . ?s1 ?s1textp ?o1 . ?o1 bif:contains &#39;&quot;CEO&quot;&#39; . } order by ?s1 limit 100 offset 10300 } }
</programlisting><para>to provide, in this instance, the result set for page 104 of the collection, where the chosen page size is 100 items.</para>
<para>The &quot;order by/limit/offset&quot; construct used by this query is subject to a Virtuoso limit, MaxTopSortedRows, which may be hit when handling very large collections.
 MaxSortedTopRows limits the combined size of the limit and offset in an &#39;order by&#39; query.
 The default value is 10000.
 Ordinarily, an error similar to: </para>
<programlisting>Error: (22023) SR353: Sorted TOP clause specifies more then 10400 rows to sort. Only 10000 are allowed. Either decrease the offset and/or row count or use a scrollable cursor&quot;
</programlisting><para>might result, but the Facet Pivot Bridge protects against this condition arising by limiting, if necessary, the number of pages in a collection.
 When such a limit is imposed, the &#39;Last Page&#39; link in the &#39;Related Collections&#39; section of PivotViewer&#39;s Info Panel will read &#39;Last Page (collection truncated)&#39;.
 This condition will only arise when handling very large collections.
 It can be avoided by increasing the value of the MaxTopSortedRows parameter under the &quot;Parameters&quot; section of the virtuoso.ini configuration file.</para>
<para> </para>
</ulink></ulink></ulink></ulink></ulink></ulink></section></docbook>