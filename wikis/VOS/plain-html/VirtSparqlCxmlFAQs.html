<html><body><div class="topic-text"><!--Begin of %META:TOPICPARENT{name="VirtSparqlCxml"}%--><p> </p>
<!--End of %META:TOPICPARENT{name="VirtSparqlCxml"}%--><p> </p>
<h1><a name="Pivot Collections (Part 8)"></a>Pivot Collections (Part 8)</h1>
<h2><a name="Contents"></a>Contents</h2>
<p>Part 1: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxml" class="wikiword">Introduction</a></p>
<p>Part 2: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxml" class="wikiword">SparqlCxml</a></p>
<p>Part 3: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxmlDzcs" class="wikiword">SparqlCxml Deep Zoom Collections</a></p>
<p>Part 4: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxmlPivotViewer" class="wikiword">PivotViewer</a></p>
<p>Part 5: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxmlImport" class="wikiword">Importing CXML</a></p>
<p>Part 6: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxmlFacetPivotBridge" class="wikiword">Facet Pivot Bridge</a></p>
<p>Part 7: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxmlDETs" class="wikiword">DETs : Persisting SPARQL Query Results to DAV</a></p>
<p>Part 8: Frequently Asked Questions (FAQs)</p>
<ul><li><a href="#AncSparqlCxmlFAQs" style="anchorhere">Frequently Asked Questions</a> <ul><li><a href="#AncFaqSparqlCxml" style="anchorhere"><nowiki>SparqlCxml</nowiki> FAQs</a> <ul><li><a href="#AncSCFaqSparqlCxmlReleases" style="anchorhere">Which Virtuoso releases support <nowiki>SparqlCxml</nowiki> and <nowiki>PivotViewer</nowiki>?</a> </li>
<li><a href="#AncSCFaqThirdPartySparqlEndpoints" style="anchorhere">Are third-party (non-Virtuoso) SPARQL endpoints supported?</a> </li>
<li><a href="#AncSCSparqlQryTypes" style="anchorhere">Which SPARQL query types does <nowiki>SparqlCxml</nowiki> support?</a> </li>
<li><a href="#AncSCCxmlSizeLimits" style="anchorhere">Are there limits on the size of a collection? How are large result sets handled?</a> </li>
<li><a href="#AncSCImageMagick" style="anchorhere">Do I need to install <nowiki>ImageMagick</nowiki>?</a> </li>
<li><a href="#AncSCSlowToLoad" style="anchorhere">Why are my collections sometimes slow to load?</a> </li>
<li><a href="#AncSCLoadTimeReduction" style="anchorhere">How can I reduce the collection load time?</a> </li>
</ul></li>
<li><a href="#AncFaqPivotViewer" style="anchorhere"><nowiki>PivotViewer</nowiki> FAQs</a> <ul><li><a href="#AncPVFaqBrowserPlatform" style="anchorhere">Which browsers and platforms support <nowiki>PivotViewer</nowiki>?</a> </li>
<li><a href="#AncPVFaqPermalinks" style="anchorhere">Can I create social bookmarks to <nowiki>PivotViewer</nowiki> collections?</a> </li>
<li><a href="#AncPVFaqMapProvider" style="anchorhere">Which web mapping services does <nowiki>PivotViewer</nowiki> support?</a> </li>
<li><a href="#AncPVFaqPresResDecoupling" style="anchorhere">How do I decouple presentation from representation?</a> </li>
<li><a href="#AncPVCollLoadsImagesBlank" style="anchorhere">My collection has loaded but why are my images blank?</a> </li>
<li><a href="#AncPVLoadedEmpty" style="anchorhere"><nowiki>PivotViewer</nowiki> has loaded but why is it empty?</a> </li>
<li><a href="#AncPVFixParseError" style="anchorhere">How can I fix a <nowiki>PivotViewer</nowiki> collection parsing error?</a> </li>
<li><a href="#AncPVFixDownloadError" style="anchorhere">How can I fix a <nowiki>PivotViewer</nowiki> collection downloading error?</a></li>
</ul></li>
</ul></li>
</ul><p>Part 9: <a href="http://vos.openlinksw.com:80/dataspace/owiki/wiki/VOS/VirtSparqlCxmlGlossary" class="wikiword">Glossary</a></p>
<hr><p> <a name="AncSparqlCxmlFAQs">
 </a></p>
<h2><a name="Frequently Asked Questions"></a>Frequently Asked Questions</h2>
 <hr> <a name="AncFaqSparqlCxml">
 <h3><a name="SparqlCxml FAQs"></a>SparqlCxml FAQs</h3>
<a name="AncFaqSparqlCxmlReleases">
<p> </p>
<h4><a name="Which Virtuoso releases support SparqlCxml and PivotViewer?"></a>Which Virtuoso releases support SparqlCxml and PivotViewer?</h4>
 <ul><li>SparqlCxml and PivotViewer require Virtuoso Commercial Edition V6.2 (Build 3129 or later).
 SparqlCxml is not supported in Virtuoso Open Source Edition (VOS).</li>
</ul><a name="AncSCFaqThirdPartySparqlEndpoints">
<p> </p>
<h4><a name="Are third-party (non-Virtuoso) SPARQL endpoints supported?"></a>Are third-party (non-Virtuoso) SPARQL endpoints supported?</h4>
 <ul><li>Third-party SPARQL endpoints are supported through Virtuoso&#39;s SPARQL-FED (Federated SPARQL) support.
 CXML can be generated from a third-party endpoint without this native facility by routing the query through a Virtuoso SPARQL endpoint, stipulating the third-party endpoint in a SERVICE clause.</li>
</ul><a name="AncSCSparqlQryTypes">
<p> </p>
<h4><a name="Which SPARQL query types does SparqlCxml support?"></a>Which SPARQL query types does SparqlCxml support?</h4>
 <ul><li>SparqlCxml, that is CXML generated directly from the /sparql endpoint, supports SELECT, DESCRIBE and CONSTRUCT queries.
 All CXML generated by the Facet Pivot Bridge uses an internal DESCRIBE.</li>
</ul><a name="AncSCCxmlSizeLimits">
<p> </p>
<h4><a name="Are there limits on the size of a collection? How are large result sets handled?"></a>Are there limits on the size of a collection? How are large result sets handled?</h4>
 <ul><li>Memory constraints limit the maximum collection size the Silverlight PivotViewer control can handle.
 To mitigate the effects of this limit, the Facet Pivot Bridge supports paged collections.
 Large collections are split into pages whose size is controlled through a &#39;Page size&#39; control in the bridge interface.
 Each page constitutes a sub-collection, containing no more than the number of items specified by the page size.
 The sub-collections are linked through first, last, next and previous links under the &#39;Related Collections&#39; section of the PivotViewer display.
 The bridge also imposes a configurable limit (default 5MB) on the size of the CXML files it generates.
</li>
<li>Collections generated directly from queries against a Virtuoso /sparql endpoint can be controlled through an appropriate LIMIT qualifier.</li>
</ul><a name="AncSCImageMagick">
<p> </p>
<h4><a name="Do I need to install ImageMagick?"></a>Do I need to install ImageMagick?</h4>
 <ul><li>No.
 Virtuoso Commercial Edition releases include a bundled ImageMagick plugin.
 The plugin is standalone and includes all the functionality needed to generate Deep  Zoom images.</li>
</ul><a name="AncSCSlowToLoad">
<p> </p>
<h4><a name="Why are my collections sometimes slow to load?"></a>Why are my collections sometimes slow to load?</h4>
 <ul><li>PivotViewer collections can be significantly slower to load than a simple web page.
 Many factors can influence the load time, however there are several actions you can take to reduce it.
 Choosing between them requires understanding which parts of the collection delivery pipeline can be the most time-intensive.
 Possible factors to consider include: <ul><li>The characteristics of the SPARQL query and the result set size <ul><li>Virtuoso&#39;s query execution speed is generally excellent.
 Obviously though, the query time is heavily influenced by the result set size.
 SPARQL-FED queries to a remote sparql endpoint will, unsurprisingly, be slower than to the local endpoint.
</li>
</ul></li>
<li>Loading of the collection by the PivotViewer control <ul><li>The CXML file for large collections can be several MBs.
 Depending on the available bandwidth, there may be a noticeable delay while PivotViewer retrieves and loads a file of this size.
</li>
</ul></li>
<li>Image processing and rendering <ul><li>In addition to the normal query processing and conversion of the result set to CXML, the collection generation pipeline must generate a 3-level Deep Zoom image (DZI) pyramid for each item.
 Further, it appears that the Silverlight control doesn&#39;t work smartly with data, making no use of cursors or paging, and instead making a local cache of all the data (and images).
</li>
</ul></li>
<li>The quality of any source geo-location data <ul><li>Geo-location data directly available in the source data as latitude and longitude requires no conversion and is fast to render in PivotViewer&#39;s map view.
 Less precise location information, like place names, is converted to geo-data by passing it to Bing Map&#39;s geocode service.</li>
</ul></li>
</ul></li>
</ul><a name="AncSCLoadTimeReduction">
<p> </p>
<h4><a name="How can I reduce the collection load time?"></a>How can I reduce the collection load time?</h4>
 <ul><li>Reduce the query resultset size <ul><li>by adding a LIMIT clause to the query, if generating the CXML from a /sparql endpoint or </li>
<li>by using the Facet Pivot Bridge&#39;s collection paging feature </li>
</ul></li>
<li>Exploit SparqlCxml&#39;s image cache <ul><li>When a collection is first generated, all the images for the DZC must be downloaded, resized and converted to 3-level DZIs.
 The source images and the DZIs are then cached for 24 hours.
 Subsequent renderings of the collection inside this window will not carry this image processing overhead </li>
</ul></li>
<li>Use a materialized view <ul><li>Rather than generating a collection dynamically each time it&#39;s viewed, use a materialized view in the form of a SparqlCxml DET (a virtual hypermedia resource), or a CXML snapshot generated by the Facet Pivot Bridge.
</li>
</ul></li>
<li>Exploit PivotViewer&#39;s geo-data caching <ul><li>Encoding geo-location information directly as latitude and longitude values in the source data is the most efficient option.
 If the data instead uses location names, the overhead in converting these names to geo-data is incurred when a map view of the collection is rendered for the first time.
 Subsequent map views should be much quicker to display because all geo-data generated from place names is permanently cached in local Silverlight Application Storage (until the 1MB cache limit is reached, at which point the action taken depends on a user&#39;s Silverlight preferences).</li>
</ul></li>
</ul><hr><p> <a name="AncFaqPivotViewer">
 </a></p>
<h3><a name="PivotViewer FAQs"></a>PivotViewer FAQs</h3>
<a name="AncPVFaqBrowserPlatform">
<p> </p>
<h4><a name="Which browsers and platforms support PivotViewer?"></a>Which browsers and platforms support PivotViewer?</h4>
 <ul><li>PivotViewer is supported on all Silverlight supported platforms and browsers: <ul><li>Windows, Mac OS X </li>
<li>Firefox (3+), Internet Explorer, Safari (3+), Chrome (4+), Opera (11) </li>
<li>For precise details of Silverlight compatible browsers and operating systems (plus any required service packs), refer to <a href="http://www.microsoft.com/getsilverlight/Get-Started/Install/Default.aspx" class="absuri">Microsoft&#39;s Get Silverlight page</a>.</li>
</ul></li>
</ul><a name="AncPVFaqPermalinks">
<p> </p>
<h4><a name="Can I create social bookmarks to PivotViewer collections?"></a>Can I create social bookmarks to PivotViewer collections?</h4>
 <ul><li>Yes.
 PivotViewer integrates with the AddThis social bookmarking service via an AddThis widget.
 From the PivotViewer interface, you can create a permalink for the collection being viewed and post it to a variety of social network sites including Facebook, Twitter, Google Bookmarks, Delicious etc.
 In order to use this service, you require a key.
 PivotViewer looks for an AddThis key in the Virtuoso registry.
 If one isn&#39;t found, it uses a temporary key.
 You can add your personal AddThis key to the Virtuoso registry using Virtuoso&#39;s registry_set function, using &#39;_pivot_AddThis&#39; for the key name.</li>
</ul><a name="AncPVFaqMapProvider">
<p> </p>
<h4><a name="Which web mapping services does PivotViewer support?"></a>Which web mapping services does PivotViewer support?</h4>
 <ul><li>PivotViewer&#39;s map view works with both Google Maps and Bing Maps, with Bing Maps the preferred option.
 Location information is displayed on a fully interactive Bing map.
 In order for Bing Maps to work, you must first add a Bing maps key to the Virtuoso registry using registry_set (&#39;_pivot_BingMapsKey&#39;,&#39;yourkey&#39;).
 A Bing map key can be obtained by creating an account at the <a href="http://www.bingmapsportal.com/" class="absuri">Bing Maps Account Centre</a>.
 If a valid Bing key is not found, PivotViewer defaults to using a static Google map.</li>
</ul><a name="AncPVFaqPresResDecoupling">
<p> </p>
<h4><a name="How do I decouple presentation from representation?"></a>How do I decouple presentation from representation?</h4>
 <ul><li>One of the key tenets of Linked Data is the decoupling of the visual presentation of an entity from its data representation.
 PivotViewer supports this decoupling by making a collection&#39;s CXML data available in other raw Linked Data formats.
 These other formats (N-Triples, N3/Turtle, JSON, XML and OData) are accessible through links at the foot of the PivotViewer display which include alternate &amp;output= query string settings appended to the SPARQL query URI.
 e.g.
<ul><li>N3/Turtle: http://linkeddata.uriburner.com/sparql?default-graph-uri=?&amp;query=DESCRIBE?&amp;output=ext%2Frdf%2Bn3? </li>
<li>JSON: http://linkeddata.uriburner.com/sparql?default-graph-uri=?&amp;query=DESCRIBE?&amp;output=application%2Frdf%2Bjson </li>
</ul></li>
<li>Other (i.e.
 non-PivotViewer) presentations of an entity, for instance in HTML, can provide access to the base entity data using the same approach.
 Simply include links similiar to that below in the &lt;head&gt; section of your (static or dynamically generated) HTML page.
<br><pre><br>  &lt;link rel=&quot;alternate&quot; title=&quot;My data in Linked Data form&quot;
   type=&quot;application/rdf+xml&quot;
   href=&quot;http://linkeddata.uriburner.com/sparql?default-graph-uri=?&amp;query=DESCRIBE?&amp;output=ext%2Frdf%2Bn3/&gt;&quot; 
</pre><br></li>
<li>As an alternative to explicitly stating the required data format through &amp;output=, Virtuoso&#39;s support for HTTP content negotiation allows clients to request the desired format through HTTP Accept headers.</li>
</ul><a name="AncPVCollLoadsImagesBlank">
<p> </p>
<h4><a name="My collection has loaded but why are my images blank?"></a>My collection has loaded but why are my images blank?</h4>
 <ul><li>If the collection has loaded and the Filter Pane contains the facets but there are no images in the tile pane just a blue box when highlighted with the the mouse then there there is is a problem with the deep zoom images associated with the collection.
 If the collection has been generated by Virtuoso then it is likely that  the Virtuoso ImageMagick plugin has not been correctly loaded.
 In your virtuoso.ini in the [Plugins] section make sure you have a lines for &quot;plain, im&quot; and &quot;plain, qrcode&quot; like this: <br><pre><br>[Plugins]
LoadPath=../hosting
...
Load6=plain, im
Load7=plain, qrcode
</pre><br>Remember to restart Virtuoso if you make any changes to your virtuoso.ini.</li>
</ul><a name="AncPVLoadedEmpty">
<p> </p>
<h4><a name="PivotViewer has loaded but why is it empty?"></a>PivotViewer has loaded but why is it empty?</h4>
 <ul><li>This can happen when the PivotViewer editor is used to enter a new SPARQL query but the SPARQL-CXML VAD has not been installed.
 Download the VAD from <a href="https://virtuoso.openlinksw.com/download/" class="absuri">sparql_cxml_dav.vad</a>, install it on the server where you are executing the query then retry the query.</li>
</ul><a name="AncPVFixParseError">
<p> </p>
<h4><a name="How can I fix a PivotViewer collection parsing error?"></a>How can I fix a PivotViewer collection parsing error?</h4>
 <ul><li>On opening the collection you get a message box with the title PivotViewer Error and the message Error parsing the collection.
 This error indicates that there is a syntax error in the cxml file.
 The message box gives the URL of the collection and also a further message from the xml parser which may contain a line and character number to pinpoint exactly where the problem is.
 To resolve this kind of problem it is often helpful to look at the cxml file directly.
 Click on the <strong>CXML</strong> link in the <strong>Raw Linked Data formats</strong> section at the bottom of the page.
 Note: in FireFox, Opera and Internet Explorer the cxml is displayed as xml in the browser window, while in Safari and Chrome you will have to look at the page source.
 However, the xml formatting in FireFox, Opera and Internet Explorer may mean that the line numbers in the error message do not match the line number in the browser window so in all cases it may be best to look at the page source.
 Alternatively, you could use curl to download the file and then examine it in a text editor.</li>
</ul><a name="AncPVFixDownloadError">
<p> </p>
<h4><a name="How can I fix a PivotViewer collection downloading error?"></a>How can I fix a PivotViewer collection downloading error?</h4>
 <ul><li>On opening the collection you get a message box with the title PivotViewer Error and the message Error downloading the collection.
 This error is a very general error that means the PivotViewer has not been able to download a collection from the supplied URL and can occur for a number of reasons.
 The simplest is that the URL has been typed incorrectly.
 The message box contains the URL.
 Try pasting that URL in the address bar of a browser.
 If it is correct you should be able to see the contents of the collection cxml file.
 Note: in FireFox, Opera and Internet Explorer the cxml is displayed as xml in the browser window, while in Safari and Chrome it is best to look at the page source.
 If the URL is in the form <br><pre><br>http://your server name:your server port/proxy/?url=the collection url
</pre><br>then it can be helpful to try pasting just the collection url in to a browser.
 If just the collection url loads the cxml file correctly but the proxy url fails then the proxy service on your server may not be enabled.
<p> The second reason for encountering a download error is that the server hosting the collection has not allowed access using the clientaccesspolicy.xml or the permissions on the collection or deepzoom collection do not allow read access.
 In this case there will be a further message displayed in the message box saying that there was a Security Exception.
 For more information on the clientaccesspolicy.xml file see <a href="http://msdn.microsoft.com/en-us/library/cc197955%28v=vs.95%29.aspx." class="absuri">http://msdn.microsoft.com/en-us/library/cc197955%28v=vs.95%29.aspx.</a> </p><p> If the collection has been generated dynamically from a SPARQL query and there is a problem generating the collection then you will also get a download error.
 In the message box you may get an additional message with an HTTP response code 500 and message &quot;internal server error&quot;  This typically means that the SPARQL query has failed.
 A good troubleshooting method when this error occurs is to click on the <strong>CXML</strong> link in the <strong>Raw Linked Data formats</strong> section at the bottom of the page.
 If the query is failing then you will get a more detailed error message that should help you resolve the problem.</p></li>
</ul></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></a></div></body></html>