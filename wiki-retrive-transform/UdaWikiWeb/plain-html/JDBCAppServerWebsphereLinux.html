<html><body><div class="topic-text"><!--Begin of %META:TOPICPARENT{name="InstallConfigJDBC"}%--><p> <br></p><!--End of %META:TOPICPARENT{name="InstallConfigJDBC"}%--><p> <br></p><h1><a name="Using UDA with IBM"></a> Using UDA with IBM <nop></nop>WebSphere 6 (Linux) </h1>
<!--Begin of %TOC{}%--><p> <br></p><div class="MACRO_TOC"> <br> <div class="wikitoc"> <br>  <ul> <br><li><a href="#Required%20components">Required components</a></li> <br><li><a href="#Install%20IBM">Install IBM</a></li> <br><li><a href="#Starting%20IBM">Starting IBM</a></li> <br><li><a href="#Install">Install</a></li> <br><li><a href="#Configure%20Resources">Configure Resources</a></li><ul><li><a href="#Create%20the%20JDBC%20Provider">Create the JDBC Provider</a></li> <br><li><a href="#Create%20the%20data%20source">Create the data source</a></li> <br><li><a href="#Create%20the%20data%20source%20custom%20property">Create the data source custom property</a></li> <br></ul>
<li><a href="#Test%20the%20data%20source">Test the data source</a></li> <br><li><a href="#Prepare%20the%20Web%20Application">Prepare the Web Application</a></li>
<ul><li><a href="#Rename%20the%20.war%20file%20to%20.zip">Rename the .war file to .zip</a></li> <br><li><a href="#Edit%20JDBC%20URLs">Edit JDBC URLs</a></li> <br><li><a href="#Edit%20the%20SQL%20statement%28s%29">Edit the SQL statement(s)</a></li> <br><li><a href="#Rename%20the%20.zip%20file%20back%20to%20.war">Rename the .zip file back to .war</a></li> <br></ul>
<li><a href="#Deploy%20opltest%20Web%20Application">Deploy opltest Web Application</a></li>
<ul><li><a href="#Preparing%20for%20the%20application%20installation">Preparing for the application installation</a></li> <br><li><a href="#Application%20Security%20Warnings">Application Security Warnings</a></li> <br><li><a href="#Install%20New%20Application">Install New Application</a></li> <br></ul>
<p>  </p></ul> <br> </div> <br></div><!--End of %TOC{}%--><h2><a name="Required components"></a> Required components </h2>
<p>You will need to download the following components</p><ul><li> IBM <nop></nop>WebSphere - <a href="http://www.ibm.com" class="absuri">download</a> <br></li>
<li> opltest.war Web Application - <a href="./opltest.war" style="reluri">download</a> <br></li>
<li> OpenLink<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/OpenLink&parent=JDBCAppServerWebsphereLinux" class="wikiword">?</a> jar file - one of these, appropriate to the selected JDK/JRE - <br>
<table class="wikitable"><tr><th id="0"><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/JDBCAppServerWebsphereLinux?sort=0&col=1">JDK/JRE/JVM  </a></th><th id="1">OpenLink<a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/OpenLink&parent=JDBCAppServerWebsphereLinux" class="wikiword">?</a> JDBC Driver  </th></tr><tr><td align="center">  1.1  </td><td align="center">  [[<a href="http://www.openlinksw.com/" class="absuri">http://www.openlinksw.com/</a>][opljdbc.jar]]  </td></tr><tr><td align="center">  1.2 or 1.3  </td><td align="center">  [[<a href="http://www.openlinksw.com/" class="absuri">http://www.openlinksw.com/</a>][opljdbc2.jar]]  </td></tr><tr><td align="center">  1.4 or 1.5  </td><td align="center">  [[<a href="http://www.openlinksw.com/" class="absuri">http://www.openlinksw.com/</a>][opljdbc3.jar]]  </td></tr><tr><td align="center">  1.6  </td><td align="center">  [[<a href="http://www.openlinksw.com/" class="absuri">http://www.openlinksw.com/</a>][opljdbc4.jar]]  </td></tr><tr><td align="center">  1.7  </td><td align="center">  [[<a href="http://www.openlinksw.com/" class="absuri">http://www.openlinksw.com/</a>][opljdbc4_1.jar]]  </td></tr><tr><td align="center">  1.7  </td><td align="center">  [[<a href="http://www.openlinksw.com/" class="absuri">http://www.openlinksw.com/</a>][opljdbc4_2.jar]]  </td></tr></table>
</li>
</ul><p> <br></p><h2><a name="Install IBM"></a> Install IBM <nop></nop>WebSphere </h2>
<p>Currently, there is only a graphical install available on Linux.</p><p>The <tt>-console</tt> command line option is not currently implemented.</p><p>Extract the .tar.gz into a suitable temporary directory, such as -- <br><tt>/tmp/websphere</tt></p><p>Double click on -- <tt>/tmp/websphere/WAS/install</tt> -- to initiate the installation process.</p><p>Select <tt>Next</tt>, Accept the license agreement then <tt>Next</tt> again.</p><p>A System Prerequisites Check will be performed.</p><p>NOTE: You may be warned that the Operating System is not supported.
 Ignore this warning.</p><p>Select Next several times leaving all options at their default values to begin the installation.</p><p>Untick <tt>Launch the First Steps Console</tt> then select <tt>Finish</tt>.</p><p> <br></p><h2><a name="Starting IBM"></a> Starting IBM <nop></nop>WebSphere Server </h2>
<p>Start IBM <nop></nop>WebSphere Server using the command -- <br><tt>/opt/IBM/WebSphere/AppServer/bin/startServer server1</tt></p><p>Browse to the following url to verify that Sun Java Application Server is up and running -- <br><tt>http://websphere_server:9060/ibm/console/</tt></p><p>NOTE: The IBM <nop></nop>WebSphere Server may take several minutes to start.</p><p> <br></p><h2><a name="Install"></a> Install <nop></nop>OpenLink jar files </h2>
<p>Copy the <tt>.jar</tt> file chosen for your JDK/JVM/JRE <br>into the directory -- <tt>/opt/IBM/WebSphere/AppServer/openlink/lib</tt></p><p>NOTE: Create this directory if it does not exist.</p><p>Open the Admin Console -- <br><tt>http://websphere_server:9060/ibm/console/</tt></p><p>Enter any User ID then select <tt>Log in</tt></p><p>Select <tt>Environment -&gt; <nop></nop>WebSphere Variables</tt></p><p>Select the variable -- <br><tt>User-defined_JDBC_DRIVER_PATH</tt></p><p>Edit the <tt>Value</tt> property to read-- <br><tt>${WAS_INSTALL_ROOT}/openlink/lib</tt></p><p>Select <tt>Apply</tt></p><p>The page will refresh with a message ot the top prompting to save the changes to the master configuration.</p><p>Select <tt>Save</tt> then select <tt>Save</tt> again.</p><p>The <nop></nop>WebSphere Variables page will redisplay.</p><p>Restart <nop></nop>WebSphere -- <br><tt>/opt/IBM/WebSphere/AppServer/bin/stopServer server1<br>/opt/IBM/WebSphere/AppServer/bin/startServer server1</tt></p><p>NOTE: The IBM <nop></nop>WebSphere Server may take several minutes to start.</p><p> <br></p><h2><a name="Configure Resources"></a> Configure Resources </h2>
<p>NOTE: These instructions must be followed precisely.</p><h3><a name="Create the JDBC Provider"></a> Create the JDBC Provider </h3>
<p>Open the Admin Console -- <br><tt>http://websphere_server:9060/ibm/console/</tt></p><p>and enter any User ID then select <tt>Log in</tt></p><p>Select <tt>Resources -&gt; JDBC Providers</tt></p><p>Select <tt>New</tt></p><p>In the <tt>Step 1</tt> list box select <tt>User-defined</tt> then <tt>Next</tt></p><p>Enter the <tt>General Properties</tt> --
</p><table class="wikitable"><td> *Name*  </td><td> opljdbc3  </td>
<tr><td> *Class path*  </td><td> ${User-defined_JDBC_DRIVER_PATH}/opljdbc3.jar  </td></tr>
<tr><td> *Implementation class name*  </td><td> openlink.javax.OPLConnectionPoolDataSource  </td></tr>
</table>
<p>Select <tt>Apply</tt></p><p>The page will refresh with a message at the top prompting to save the changes to the master configuration.</p><p>Select <tt>Save</tt> then select <tt>Save</tt> again.</p><p>The <tt>JDBC providers</tt> page will redisplay with the provider <tt>opljdbc3</tt> added to the list.</p><p> <br></p><h3><a name="Create the data source"></a> Create the data source </h3>
<p>Select the provider you just created.</p><p>Select <tt>Data Sources</tt> to the right of the providers <tt>General Properties</tt></p><p>Select <tt>New</tt></p><p>Enter the <tt>General Properties</tt> --
</p><table class="wikitable"><td> *Name*  </td><td> o32opljdbc3  </td>
<tr><td> *JNDI name*  </td><td> jdbc/o32opljdbc3  </td></tr>
</table>
<p>Select the <tt>Select a data store helper class</tt> radio button and highlight the class -- <br><tt>(com.ibm.websphere.rsadapter.GenericDataStoreHelper)</tt></p><p>Select <tt>Apply</tt></p><p>The page will refresh with a message at the top prompting to save the changes to the master configuration.</p><p>Select <tt>Save</tt> then select <tt>Save</tt> again.</p><p>The <tt>Data sources</tt> page will redisplay with the data source <tt>o32opljdbc3</tt> added to the list.</p><p> <br></p><h3><a name="Create the data source custom property"></a> Create the data source custom property </h3>
<p>Select the data source you just created.</p><p>Select <tt>Custom properties</tt> to the right of the providers <tt>General Properties</tt></p><p>Select <tt>New</tt></p><p>Enter the <tt>General Properties</tt> --
</p><table class="wikitable"><td> *Name*  </td><td> URL  </td>
<tr><td> *Value*  </td><td> jdbc:openlink:<em>192.168.0.150:5000/SVT<p>Odbc/Database</p><p>sqlserver/UID</p><p>sa/PWD</p><p>sa  </p></em></td></tr>
<tr><td> *Type*  </td><td> java.lang.String  </td></tr>
</table>
<p>Select <tt>Apply</tt></p><p>The page will refresh with a message ot the top prompting to save the changes to the master configuration.</p><p>Select <tt>Save</tt> then select <tt>Save</tt> again.</p><p>The Custom properties page will redisplay with the custom property added to the list.</p><p> <br></p><h2><a name="Test the data source"></a> Test the data source </h2>
<p>Select <tt>Data sources</tt> in the navigation structure at the top of the page.</p><p>Tick the data source you just created.</p><p>Select <tt>Test connection</tt></p><p>You will need to repeat the above for the following providers / data sources / JNDI Names --
</p><table class="wikitable"><th id="2"><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/JDBCAppServerWebsphereLinux?sort=2&col=1">Provider  </a></th><th id="3"><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/JDBCAppServerWebsphereLinux?sort=3&col=2">Data source  </a></th><th id="4"><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/JDBCAppServerWebsphereLinux?sort=4&col=3">JNDI name  </a></th>
<tr><td> opljdbc2  </td><td> o32opljdbc2  </td><td> jdbc/o32opljdbc2  </td></tr>
<tr><td> opljdbc2  </td><td> m32opljdbc2  </td><td> jdbc/m32opljdbc2  </td></tr>
<tr><td> opljdbc3  </td><td> o32opljdbc3  </td><td> jdbc/o32opljdbc3  </td></tr>
<tr><td> opljdbc3  </td><td> m32opljdbc3  </td><td> jdbc/m32opljdbc3  </td></tr>
</table>
<p> <br></p><h2><a name="Prepare the Web Application"></a> Prepare the Web Application </h2>
<p>Demonstrating how to build and deploy a Web application from the beginning is beyond the scope of this short tutorial so what follows is a quick method of altering the JDBC URLs and SQL statements in an existing Web application.</p><p>NOTE: Be careful when moving .war files about using Internet Explorer.
 Sometimes they will be renamed to .zip by Internet Explorer.</p><h3><a name="Rename the .war file to .zip"></a> Rename the .war file to .zip </h3>
<p>Rename - <tt>opltest.war</tt> -to- <tt>opltest.zip</tt></p><p>You will then be able to unzip the archive to get at the files inside it.
 (Some utilities can unzip the .war archive without renaming.) <br><tt>unzip opltest.zip</tt></p><h3><a name="Edit JDBC URLs"></a> Edit JDBC URLs </h3>
<p>Edit the driver class and the JDBC connection URL in the file -- <br><tt>/META-INF/context.xml</tt></p><p>NOTE: Ensure that the edited file is placed back into the archive.
<br><tt>zip -r ../opltest *</tt></p><p> <br></p><h3><a name="Edit the SQL statement(s)"></a> Edit the SQL statement(s) </h3>
<p>You will need to edit the SQL statement(s) in <i>the following JSP files</i> based on the chosen database determined by the JDBC URL in the file -- <br><tt>/META-INF/context.xml</tt></p><p>Edit the JSP files -- <br><br></p><pre>opljdbc.jsp
opljdbc2.jsp 
opljdbc3.jsp
</pre><p> <br>There are two main areas of interest --</p><ol><li>The &lt;sql:query&gt; tag which select the datasource as defined in - <tt>/META-INF/context.xml</tt><br> <br>which contains the SQL query itself -- <br> <br><tt>&lt;sql:query var=&quot;resultset&quot; dataSource=&quot;jdbc/opljdbc2&quot;&gt;<br>		select SupplierID, CompanyName, ContactName, ContactTitle from Suppliers<br>	&lt;/sql:query&gt;</tt> <br>		<br> <br></li>
<li>The one or more ${row.column_name} constructs that output data as per the SQL query <br> <br><tt>${row.SupplierID}<br>${row.CompanyName} </tt></li>
</ol><p> <br>NOTE: Ensure that the edited file is placed back into the archive.
<br><tt>zip -r ../opltest *</tt></p><h3><a name="Rename the .zip file back to .war"></a> Rename the .zip file back to .war </h3>
<p>Rename the file <tt>opltest.zip</tt> back to <tt>opltest.war</tt></p><p> <br></p><h2><a name="Deploy opltest Web Application"></a> Deploy opltest Web Application </h2>
<p>Open the Admin Console -- <br><tt>http://websphere_server:9060/ibm/console/</tt></p><p>and enter any User ID then select <tt>Log in</tt></p><p>Select <tt>Applications -&gt; Install New Application</tt></p><h3><a name="Preparing for the application installation"></a> Preparing for the application installation </h3>
<p>Select the <tt>Local file system</tt> radio button.</p><p>Browse to the war file <tt>optest.war</tt></p><p>Set the <tt>Context root</tt> to -- <br><tt>opltest</tt></p><p>Select <tt>Next</tt> then <tt>Next</tt> again</p><h3><a name="Application Security Warnings"></a> Application Security Warnings </h3>
<p>Select <tt>Continue</tt></p><h3><a name="Install New Application"></a> Install New Application </h3>
<ol><li> Select installation options <br> <br>Change the <tt>Application name</tt> to <tt>opltest</tt><br> <br>Select <tt>Next</tt><br> <br></li>
<li> Map modules to servers<br> <br>Select <tt>Next</tt><br> <br></li>
<li> Map resource references to resources<br> <br>Scroll down the page to see the table showing the resources defined by the file WEB-INF/web.xml<br> <br>Enter the <tt>JNDI name</tt> for its corresponding <tt>Reference binding</tt> as follows --<br> <br>
<table class="wikitable">
<tr><th id="5"><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/JDBCAppServerWebsphereLinux?sort=5&col=1">Reference binding  </a></th><th id="6"><a href="http://wikis.openlinksw.com:80/dataspace/owiki/wiki/UdaWikiWeb/JDBCAppServerWebsphereLinux?sort=6&col=2">JNDI name  </a></th></tr>
<tr><td> jdbc/o32opljdbc1  </td><td> jdbc/o32opljdbc3  </td></tr>
<tr><td> jdbc/m32opljdbc1  </td><td> jdbc/m32opljdbc3  </td></tr>
<tr><td> jdbc/o32opljdbc2  </td><td> jdbc/o32opljdbc2  </td></tr>
<tr><td> jdbc/m32opljdbc2  </td><td> jdbc/m32opljdbc2  </td></tr>
<tr><td> jdbc/o32opljdbc3  </td><td> jdbc/o32opljdbc3  </td></tr>
<tr><td> jdbc/m32opljdbc3  </td><td> jdbc/m32opljdbc3  </td></tr>
</table>
 <br>Select <tt>Next</tt><br> <br></li>
<li> Map virtual hosts for Web modules<br> <br>Select <tt>Next</tt><br> <br></li>
<li> Summary<br> <br>Select <tt>Finish</tt></li>
</ol><p>The application will now be installed.</p><p>Select the <tt>Save to Master Configuration</tt> link at the bottom of the page.</p><p>Select <tt>Save</tt></p><p>Select <tt>Applications -&gt; Enterprise Applications</tt></p><p>You will see the new application <tt>opltest</tt> listed with a red cross for its status.</p><p>Select the check box to the left of <tt>opltest</tt></p><p>Select <tt>Start</tt></p><p>The page will refresh and the red cross will have changed to a green arrow.</p><p>The newly deployed application is now available at the following URL -- <br><tt>http://websphere_server:9080/opltest/index.html</tt></p></div></body></html>