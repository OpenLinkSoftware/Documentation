<div id="eesqlwin" class="sect1">

<div class="titlepage">

<div>

<div>

## 10.2.  OpenLink ODBC Driver for SQL Server (Express Editon) for Windows

</div>

</div>

</div>

<div id="eesqlwininst" class="sect2">

<div class="titlepage">

<div>

<div>

### 10.2.1. Installation

</div>

</div>

</div>

The OpenLink ODBCDriver for Microsoft SQLServer (Express Edition) is
distributed as a Windows MSI installer. Simply double click on the
installer 'ntl6esql.msi' to commence the installation.

Installer Welcome Dialog for the OpenLink ODBCDriver for Microsoft
SQLServer(Express Edition):

<div id="id39351" class="figure">

**Figure 10.27. EEWinSQLServerScreen1i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen1i.png](images/EEWinSQLServerScreen1i.png)

</div>

</div>

</div>

  

Please read the software license agreement and accept before continuing
your installation:

<div id="id39358" class="figure">

**Figure 10.28. EEWinSQLServerScreen3i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen3i.png](images/EEWinSQLServerScreen3i.png)

</div>

</div>

</div>

  

Before installation, you will be prompted for a license file. If a
license file already exists on the machine, then select the 'use
exisiting file' option. A trial (try) or full (buy) license can be
obtained by selecting the 'try and buy' option which loads OpenLink's
online try and buy web page:

<div id="id39365" class="figure">

**Figure 10.29. EEWinSQLServerScreen4i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen4i.png](images/EEWinSQLServerScreen4i.png)

</div>

</div>

</div>

  

If you are using Nortons Anti-Virus Software, you may encouter this
warning message. Choose the Allow the Entire Script once option:

<div id="id39372" class="figure">

**Figure 10.30. EEWinSQLServerScreen5i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen5i.png](images/EEWinSQLServerScreen5i.png)

</div>

</div>

</div>

  

To obtain the trial license, you must be a registered user on the
OpenLinkWeb site and login with your username (e-mail address) and
password for that user. Click on the 'Shop' link to visit Openlink's
online shop cart to purchase a full license, if required:

<div id="id39379" class="figure">

**Figure 10.31. EEWinSQLServerScreen6i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen6i.png](images/EEWinSQLServerScreen6i.png)

</div>

</div>

</div>

  

Click on the 'download license' button to immediatly obtain the license
file and save it to your desktop. Alternatively, an auto-generated
e-mail will be sent to your registered user's e-mail address with a link
to your OpenLinkData Space ( ODS), which contains all trial and full
licenses in a Briefcase for download at a later date.

<div id="id39386" class="figure">

**Figure 10.32. EEWinSQLServerScreen7i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen7i.png](images/EEWinSQLServerScreen7i.png)

</div>

</div>

</div>

  

You will want to save the file to disk:

<div id="id39393" class="figure">

**Figure 10.33. EEWinSQLServerScreen8i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen8i.png](images/EEWinSQLServerScreen8i.png)

</div>

</div>

</div>

  

Select the license file to be used for the installation:

<div id="id39400" class="figure">

**Figure 10.34. EEWinSQLServerScreen9i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen9i.png](images/EEWinSQLServerScreen9i.png)

</div>

</div>

</div>

  

Make sure that the path to where the license file is located is correct
before selecting Next:

<div id="id39407" class="figure">

**Figure 10.35. EEWinSQLServerScreen10i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen10i.png](images/EEWinSQLServerScreen10i.png)

</div>

</div>

</div>

  

Choose to perform a custom, typical, or complete installation of the
driver:

<div id="id39414" class="figure">

**Figure 10.36. EEWinSQLServerScreen11i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen11i.png](images/EEWinSQLServerScreen11i.png)

</div>

</div>

</div>

  

With a custom installation, you can decide the directory where the
installation will reside:

<div id="id39421" class="figure">

**Figure 10.37. EEWinSQLSErverCustom1.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLSErverCustom1.png](images/EEWinSQLSErverCustom1.png)

</div>

</div>

</div>

  

Select the features to be installed:

<div id="id39428" class="figure">

**Figure 10.38. EEWinSQLSErverCustom2.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLSErverCustom2.png](images/EEWinSQLSErverCustom2.png)

</div>

</div>

</div>

  

Click the install button to begin installation of the components:

<div id="id39435" class="figure">

**Figure 10.39. EEWinSQLSErverCustom3.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLSErverCustom3.png](images/EEWinSQLSErverCustom3.png)

</div>

</div>

</div>

  

Installation in progress:

<div id="id39442" class="figure">

**Figure 10.40. EEWinSQLServerScreen13i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen13i.png](images/EEWinSQLServerScreen13i.png)

</div>

</div>

</div>

  

The software installation is complete and ready for use:

<div id="id39449" class="figure">

**Figure 10.41. EEWinSQLServerScreen14i.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen14i.png](images/EEWinSQLServerScreen14i.png)

</div>

</div>

</div>

  

</div>

<div id="eesqlwinconf" class="sect2">

<div class="titlepage">

<div>

<div>

### 10.2.2. Configuration

</div>

</div>

</div>

To configure an ODBCDSN, run the ODBCAdministrator located in the
Administrative Tools section of the Control Panel:

<div id="id39458" class="figure">

**Figure 10.42. EEWinSQLServerScreen1c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen1c.png](images/EEWinSQLServerScreen1c.png)

</div>

</div>

</div>

  

From either the User or System DSN tab, click on the Add button:

<div id="id39465" class="figure">

**Figure 10.43. EEWinSQLServerScreen2c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen2c.png](images/EEWinSQLServerScreen2c.png)

</div>

</div>

</div>

  

Select the OpenLinkSQLServer ODBCDriver \[Express Edition\]\[6.0\] from
the list presented:

<div id="id39472" class="figure">

**Figure 10.44. EEWinSQLServerScreen3c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen3c.png](images/EEWinSQLServerScreen3c.png)

</div>

</div>

</div>

  

In the Data Source tab, select a suitable DSN name and optional
description for the Data Source to be created:

<div id="id39479" class="figure">

**Figure 10.45. EEWinSQLServerScreen4c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen4c.png](images/EEWinSQLServerScreen4c.png)

</div>

</div>

</div>

  

The Connection tab requests the minimum parameters required to make a
connection to the target database:

<div id="id39486" class="figure">

**Figure 10.46. EEWinSQLServerScreen5c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen5c.png](images/EEWinSQLServerScreen5c.png)

</div>

</div>

</div>

  

<div class="itemizedlist">

- <span class="emphasis">*Server Type*</span> : This parameter should be
  set to MSSQL, which can be selected from the drop down list box.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Host*</span> : This is the fully qualified
  hostname, or IP address, of the machine hosting the DBMS you wish to
  access, e.g., dbms-server.example.com, or 192.168.155.123. Any
  hostname which will be resolved by your local DNS is acceptable.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Port*</span> : This is the port that SQL
  Server is listening on

</div>

<div class="itemizedlist">

- <span class="emphasis">*Database*</span> : This is the SQL Server
  database to which you want to connect

</div>

<div class="itemizedlist">

- <span class="emphasis">*Login ID*</span> : This is a valid user on for
  the SQL Server Database

</div>

<div class="itemizedlist">

- <span class="emphasis">*Password*</span> : This is a valid password on
  for the SQL Server Database

</div>

Click next to verify that all settings are correct or uncheck the check
box to delay testing to a later stage.

The advanced button displays additional, optional parameters that can be
configured:

<div id="id39518" class="figure">

**Figure 10.47. EEWinSQLSErverAdvanced.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLSErverAdvanced.png](images/EEWinSQLSErverAdvanced.png)

</div>

</div>

</div>

  

<div id="id39523" class="table">

**Table 10.2. **

<div class="table-contents">

|                                                               |
|---------------------------------------------------------------|
| <span class="emphasis">*Tds*</span>                           |
| <span class="emphasis">*Cachemetadata*</span>                 |
| <span class="emphasis">*Charset*</span>                       |
| <span class="emphasis">*Language*</span>                      |
| <span class="emphasis">*Domain*</span>                        |
| <span class="emphasis">*Instance*</span>                      |
| <span class="emphasis">*AppName*</span>                       |
| <span class="emphasis">*ProgName*</span>                      |
| <span class="emphasis">*Wsid*</span>                          |
| <span class="emphasis">*MacAddress*</span>                    |
| <span class="emphasis">*SendStringParametersAsUnicode*</span> |
| <span class="emphasis">*LastUpdateCount*</span>               |
| <span class="emphasis">*PrepareSQL*</span>                    |
| <span class="emphasis">*PacketSize*</span>                    |
| <span class="emphasis">*TcpNoDelay*</span>                    |
| <span class="emphasis">*LobBuffer*</span>                     |
| <span class="emphasis">*MaxStatements*</span>                 |
| <span class="emphasis">*LoginTimeout*</span>                  |
| <span class="emphasis">*SocketTimeout*</span>                 |
| <span class="emphasis">*NamedPipe*</span>                     |
| <span class="emphasis">*Ssl*</span>                           |
| <span class="emphasis">*BatchSize*</span>                     |
| <span class="emphasis">*UseCursors*</span>                    |
| <span class="emphasis">*BufferMaxMemory*</span>               |
| <span class="emphasis">*BufferMinPackets*</span>              |
| <span class="emphasis">*UseLOBs*</span>                       |

</div>

</div>

  

As indicated above, the parameters on the options and preferences tabs
are not required for a basic connection.

<div id="id39633" class="figure">

**Figure 10.48. EEWinSQLServerScreen6c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen6c.png](images/EEWinSQLServerScreen6c.png)

</div>

</div>

</div>

  

<div class="itemizedlist">

- <span class="emphasis">*Drop Catalog name from DatabaseMetaData
  calls*</span> - Enable this option to have the catalog name not appear
  for tables, views, and procedures when requesting database meta-data.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Drop Schema name from DatabaseMetaData
  calls*</span> - Enable this option to have the schema-name not appear
  for tables, views, and procedures when requesting database meta-data.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Return an empty ResultSet for
  SQLStatistics*</span> - Check this box to have SQLStatistics() return
  an empty resultset. Use this if the underlying database does not
  support retrieving statistics about a table (e.g., what indexes there
  are on it).

</div>

<div class="itemizedlist">

- <span class="emphasis">*Disable support of quoted identifier*</span> -
  If it is set, the call SQLGetInfo for 'SQL_IDENTIFIER_QUOTE_CHAR' will
  return the space (" "). It can be used if DBMS does not support quoted
  SQL, e.g., select \* from "account."

</div>

<div class="itemizedlist">

- <span class="emphasis">*Disable support of search pattern
  escape*</span> - If it is set, the call SQLGetInfo for
  'SQL_LIKE_ESCAPE_CLAUSE' will return the space (" "). It can be used
  if DBMS does not support SQL escape patterns

</div>

<div class="itemizedlist">

- <span class="emphasis">*Patch of NULL size of SQL_CHAR*</span> - If
  set, this option overrides the size of SQL_CHAR column type returned
  by the database with the value set in the text box (in bytes). With
  the default value of 0, the driver uses the size returned by the
  database.

</div>

<div id="id39663" class="figure">

**Figure 10.49. EEWinSQLServerScreen7c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen7c.png](images/EEWinSQLServerScreen7c.png)

</div>

</div>

</div>

  

<div class="itemizedlist">

- <span class="emphasis">*Read Only connection*</span> - Specify whether
  the connection is to be "Read-only". Make sure the checkbox is
  unchecked to request a "Read/Write" connection.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Disable interactive login*</span> - Suppress
  the ODBC "Username" and "Password" login dialog box when interacting
  with your ODBC DSN from within an ODBC compliant application.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Row Buffer Size*</span> - This attribute
  specifies the number of records to be transported over the network in
  a single network hop. Values can range from 1 to 99.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Max Rows Override*</span> - Allows you to
  define a limit on the maximum number of rows to be returned from a
  query. The default value of 0 means no limit.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Initial SQL*</span> - Lets you specify a file
  containing SQL statements that will be automatically run against the
  database upon connection.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Dynamic Cursor Sensitivity*</span> - Enables
  or disables the row version cache used with dynamic cursors. When
  dynamic cursor sensitivity is set high, the Cursor Library calculates
  checksums for each row in the current rowset and compares these with
  the checksums (if any) already stored in the row version cache for the
  same rows when fetched previously. If the checksums differ for a row,
  the row has been updated since it was last fetched, and the row status
  flag is set to SQL_ROW_UPDATED. The row version cache is then updated
  with the latest checksums for the rowset. From the user's point of
  view, the only visible difference between the two sensitivity settings
  is that a row status flag can never be set to SQL_ROW_UPDATED, when
  the cursor sensitivity is low. (The row status is instead displayed as
  SQL_ROW_SUCCESS.) In all other respects, performance aside, the two
  settings are the same - deleted rows do not appear in the rowset,
  updates to the row since the row was last fetched are reflected in the
  row data, and inserted rows appear in the rowset, if their keys fall
  within the span of the rowset. If your application does not need to
  detect the row status SQL_ROW_UPDATED, you should leave the 'High
  Cursor Sensitivity' checkbox unchecked, as performance is improved.
  The calculation and comparison of checksums for each row fetched
  carries an overhead. If this option is enabled, the table oplrvc must
  have been created beforehand using the appropriate OpenLink script for
  the target database.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Enable logging to the log file:*</span> -
  Specifies the full path to a text file. If the associated checkbox is
  checked, and a file is passed, the driver will log auto-generate a
  clientside ODBC trace.

</div>

<div id="id39697" class="figure">

**Figure 10.50. EEWinSQLServerScreen8c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen8c.png](images/EEWinSQLServerScreen8c.png)

</div>

</div>

</div>

  

<div class="itemizedlist">

- <span class="emphasis">*Disable AutoCommit*</span> - Change the
  default commit behaviour of the OpenLink Lite Driver. The default mode
  is AutoCommit mode (box unchecked).

</div>

<div class="itemizedlist">

- <span class="emphasis">*Disable Rowset Size Limit*</span> - Disable
  the limitation enforced by the cursor library. The limitation is
  enforced by default to prevent the driver claiming all available
  memory in the event that a resultset is generated from an erroneous
  query is very large. The limit is normally never reached.

</div>

<div class="itemizedlist">

- <span class="emphasis">*Multiple Active Statements Emulation*</span> -
  Enables use of Multiple Active statements in an ODBC application even
  if the underlying database does not allow this, as it is emulated in
  the driver.

</div>

<div class="itemizedlist">

- <span class="emphasis">*SQL_DBMS Name*</span> - Manually override the
  SQLGetInfo(SQL_DBMS_NAME) response returned by the driver. This is
  required for products like Microsoft InfoPath for which the return the
  value must be "SQL Server".

</div>

<div id="id39719" class="figure">

**Figure 10.51. EEWinSQLServerScreen9c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen9c.png](images/EEWinSQLServerScreen9c.png)

</div>

</div>

</div>

  

Click on the <span class="emphasis">*Test Data Source*</span>button to
verify that a successful connection can be made to the database.

<div id="id39727" class="figure">

**Figure 10.52. EEWinSQLServerScreen10c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen10c.png](images/EEWinSQLServerScreen10c.png)

</div>

</div>

</div>

  

When you click finish, you will go back to the ODBCData Source
Administrator, and you should see the new DSN in the list of available
DSN's:

<div id="id39734" class="figure">

**Figure 10.53. EEWinSQLServerScreen11c.png**

<div class="figure-contents">

<div class="mediaobject">

![EEWinSQLServerScreen11c.png](images/EEWinSQLServerScreen11c.png)

</div>

</div>

</div>

  

</div>

</div>
